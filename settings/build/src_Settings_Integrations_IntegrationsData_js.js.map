{"version":3,"file":"src_Settings_Integrations_IntegrationsData_js.js","mappings":"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","sources":["webpack://complianz-gdpr/./src/Settings/Integrations/IntegrationsData.js"],"sourcesContent":["import {create} from 'zustand';\nimport produce from 'immer';\nimport * as cmplz_api from \"../../utils/api\";\n\n\nconst useIntegrations = create(( set, get ) => ({\n\tintegrationsLoaded: false,\n\tfetching:false,\n\tservices: [],\n\tplugins:[],\n\tscripts:[],\n\tplaceholders:[],\n\tblockedScripts:[],\n\tsetScript: (script, type) => {\n\t\tset(\n\t\t\tproduce((state) => {\n\t\t\t\t//update blocked scripts options list if new urls were added.\n\t\t\t\tif (type==='block_script') {\n\t\t\t\t\tlet options = state.blockedScripts;\n\t\t\t\t\tif ( script.urls ) {\n\t\t\t\t\t\tfor (const [index, url] of Object.entries(script.urls)) {\n\t\t\t\t\t\t\tif (!url || url.length===0) continue;\n\t\t\t\t\t\t\t//check if url exists in the options object\n\t\t\t\t\t\t\tlet found = false;\n\t\t\t\t\t\t\tfor (const [optionIndex, optionValue] of Object.entries(options)) {\n\t\t\t\t\t\t\t\tif (url===optionIndex) found = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!found) {\n\t\t\t\t\t\t\t\toptions[url] = url;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstate.blockedScripts = options;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst index = state.scripts[type].findIndex(item => {\n\t\t\t\t\treturn item.id===script.id;\n\t\t\t\t});\n\t\t\t\tif (index!==-1) state.scripts[type][index] = script;\n\t\t\t})\n\t\t)\n\t},\n\tfetchIntegrationsData: async ( ) => {\n\t\tif (get().fetching) return;\n\n\t\tset({fetching:true});\n\t\tconst { services, plugins, scripts, placeholders, blocked_scripts}   = await fetchData();\n\t\tlet scriptsWithId = scripts;\n\t\t//add a unique id to each script\n\t\tscriptsWithId.block_script.forEach((script, i) => {\n\t\t\tscript.id = i;\n\t\t})\n\t\tscriptsWithId.add_script.forEach((script, i) => {\n\t\t\tscript.id = i;\n\t\t})\n\t\tscriptsWithId.whitelist_script.forEach((script, i) => {\n\t\t\tscript.id = i;\n\t\t})\n\t\tset(() => ({\n\t\t\tintegrationsLoaded: true,\n\t\t\tservices: services,\n\t\t\tplugins: plugins,\n\t\t\tscripts: scriptsWithId,\n\t\t\tfetching:false,\n\t\t\tplaceholders: placeholders,\n\t\t\tblockedScripts:blocked_scripts,\n\t\t}));\n\t},\n\taddScript:(type) => {\n\t\tset({fetching:true});\n\t\tset(\n\t\t\tproduce((state) => {\n\t\t\t\tstate.scripts[type].push({'name':'general', 'id':state.scripts[type].length, 'enable':true});\n\t\t\t})\n\t\t)\n\t\tlet scripts = get().scripts;\n\t\treturn cmplz_api.doAction('update_scripts', {scripts: scripts}).then((response) => {\n\t\t\tset({fetching:false});\n\t\t\treturn response;\n\t\t}).catch((error) => {\n\t\t\tconsole.error(error);\n\t\t});\n\t},\n\tsaveScript:(script, type) => {\n\t\tset({fetching:true});\n\n\t\tset(\n\t\t\tproduce((state) => {\n\t\t\t\tconst index = state.scripts[type].findIndex(item => {\n\t\t\t\t\treturn item.id===script.id;\n\t\t\t\t});\n\t\t\t\tif (index!==-1) state.scripts[type][index] = script;\n\t\t\t})\n\t\t)\n\t\tlet scripts = get().scripts;\n\t\treturn cmplz_api.doAction('update_scripts', {scripts: scripts}).then((response) => {\n\t\t\tset({fetching:false});\n\t\t\treturn response;\n\t\t}).catch((error) => {\n\t\t\tconsole.error(error);\n\t\t});\n\t},\n\tdeleteScript:(script, type) => {\n\t\tset({fetching:true});\n\t\tset(\n\t\t\tproduce((state) => {\n\t\t\t\tconst index = state.scripts[type].findIndex(item => {\n\t\t\t\t\treturn item.id===script.id;\n\t\t\t\t});\n\t\t\t\t//drop script with this index\n\t\t\t\tif (index!==-1) state.scripts[type].splice(index, 1);\n\t\t\t})\n\t\t)\n\t\tlet scripts = get().scripts;\n\t\treturn cmplz_api.doAction('update_scripts', {scripts: scripts}).then((response) => {\n\t\t\tset({fetching:false});\n\t\t\treturn response;\n\t\t}).catch((error) => {\n\t\t\tconsole.error(error);\n\t\t});\n\t},\n\tupdatePluginStatus: async (pluginId, enabled) => {\n\t\tset(\n\t\t\tproduce((state) => {\n\t\t\t\tconst index = state.plugins.findIndex(plugin => {\n\t\t\t\t\treturn plugin.id===pluginId;\n\t\t\t\t});\n\t\t\t\tif (index!==-1) state.plugins[index].enabled = enabled;\n\t\t\t})\n\t\t)\n\t\treturn cmplz_api.doAction('update_plugin_status', {plugin: pluginId, enabled: enabled}).then((response) => {\n\t\t\treturn response;\n\t\t}).catch((error) => {\n\t\t\tconsole.error(error);\n\t\t});\n\t},\n\tupdatePlaceholderStatus: async (id, enabled, isPlugin) => {\n\t\tif (isPlugin) {\n\t\t\tset(\n\t\t\t\tproduce((state) => {\n\t\t\t\t\tconst index = state.plugins.findIndex(plugin => {\n\t\t\t\t\t\treturn plugin.id===id;\n\t\t\t\t\t});\n\t\t\t\t\tif (index!==-1) state.plugins[index].placeholder = enabled ? 'enabled' : 'disabled';\n\t\t\t\t})\n\t\t\t)\n\t\t}\n\t\treturn cmplz_api.doAction('update_placeholder_status', {id: id, enabled: enabled}).then((response) => {\n\t\t\treturn response;\n\t\t}).catch((error) => {\n\t\t\tconsole.error(error);\n\t\t});\n\t}\n}));\n\nexport default useIntegrations;\n\nconst fetchData = () => {\n\treturn cmplz_api.doAction('get_integrations_data', {}).then((response) => {\n\t\treturn response;\n\t}).catch((error) => {\n\t\tconsole.error(error);\n\t});\n}\n"],"names":["create","produce","cmplz_api","useIntegrations","set","get","integrationsLoaded","fetching","services","plugins","scripts","placeholders","blockedScripts","setScript","script","type","state","options","urls","index","url","Object","entries","length","found","optionIndex","optionValue","findIndex","item","id","fetchIntegrationsData","blocked_scripts","fetchData","scriptsWithId","block_script","forEach","i","add_script","whitelist_script","addScript","push","doAction","then","response","catch","error","console","saveScript","deleteScript","splice","updatePluginStatus","pluginId","enabled","plugin","updatePlaceholderStatus","isPlugin","placeholder"],"sourceRoot":""}