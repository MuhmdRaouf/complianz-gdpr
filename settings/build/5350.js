"use strict";(globalThis.webpackChunkcomplianz_gdpr=globalThis.webpackChunkcomplianz_gdpr||[]).push([[5350,9179,1655,9510,2588],{85350:(e,t,a)=>{a.r(t),a.d(t,{default:()=>p});var l=a(69307),n=a(39510),c=a(65736),o=a(93019),r=a(56293),i=a(43684),s=a(59179),d=a(99196),m=a(63801),u=a(32588);const p=(0,d.memo)((e=>{let{label:t,field:a}=e;const{fields:d,fileName:p,fetching:g,loadingFields:_,updating:f,regions:b,documentsLoaded:h,resetEditDocumentId:E,savedDocument:z,fetchData:v,fetchFields:y,updateField:N,save:w,editDocumentId:k,region:C,setRegion:F}=(0,n.default)(),[D,A]=(0,l.useState)(!0),[R,S]=(0,l.useState)(!1),[L,I]=(0,l.useState)(0),{allRequiredFieldsCompleted:T,fetchAllFieldsCompleted:x,fieldsLoaded:q,showSavedSettingsNotice:U}=(0,r.default)();let V=React.createRef();(0,l.useEffect)((()=>{k&&I(0),k&&V.current&&V.current.scrollIntoView({behavior:"smooth",block:"start"})}),[k]),(0,l.useEffect)((()=>{!h&&cmplz_settings.is_premium&&v()}),[h]),(0,l.useEffect)((()=>{x()}),[q]),(0,l.useEffect)((()=>{A(""===C)}),[C,g,k]);const H=async()=>{if(""!==z.downloadUrl){S(!0);const e=z.download_url;try{let t=new XMLHttpRequest;t.responseType="blob",t.open("get",e,!0),t.send(),t.onreadystatechange=function(){if(4===this.readyState&&200===this.status){let e=window.URL.createObjectURL(this.response),t=window.document.createElement("a");t.setAttribute("href",e),t.setAttribute("download",z.title),window.document.body.appendChild(t),t.click(),S(!1),setTimeout((function(){window.URL.revokeObjectURL(e)}),6e4)}}}catch(e){console.error(e),S(!1)}}},j=async()=>{await w(C),U()};(0,l.useEffect)((()=>{""===C||g||A(!1)}),[C,g]);let M=d.filter((e=>void 0===e.conditionallyDisabled||!1===e.conditionallyDisabled)),O=Math.ceil(M.length/5),P=(e=>{const t=5*(L-1),a=t+5;return e.slice(t,a)})(d);return(0,l.createElement)(l.Fragment,null,!T&&(0,l.createElement)("div",{className:"cmplz-locked"},(0,l.createElement)("div",{className:"cmplz-locked-overlay"},(0,l.createElement)("span",{className:"cmplz-task-status cmplz-warning"},(0,c.__)("Incomplete","complianz-gdpr")),(0,l.createElement)("span",null,(0,c.__)("The wizard has not been completed yet, but this field requires information from the wizard. Please complete the wizard first.","complianz-gdpr")))),0===L&&(0,l.createElement)(l.Fragment,null,k&&(0,l.createElement)("div",{className:"cmplz-selected-document"},p),(0,l.createElement)(m.default,{id:"region_for_databreaches",label:(0,c.__)("Region","complianz-gdpr"),required:!0,type:"select"}),(0,l.createElement)(u.default,{innerRef:V,disabled:f,onChange:e=>F(e),options:b,value:C,required:!0}),(0,l.createElement)("div",{className:"cmplz-table-header"},(0,l.createElement)(m.default,{id:"region_for_databreaches",label:(0,c.__)("Create Data Breach report","complianz-gdpr"),type:"button"}),(0,l.createElement)("div",{className:"cmplz-table-header-controls"},k&&(0,l.createElement)(l.Fragment,null,(0,l.createElement)("button",{disabled:f,className:"button button-default",onClick:()=>{E(),I(0)}},(0,c.__)("Cancel","complianz-gdpr")),(0,l.createElement)("button",{disabled:f,className:"button button-primary",onClick:()=>I(L+1)},(0,c.__)("Next","complianz-gdpr")),(0,l.createElement)("button",{disabled:f,className:"button button-primary",onClick:()=>j()},(0,c.__)("Save","complianz-gdpr"))),!k&&(0,l.createElement)(l.Fragment,null,(0,l.createElement)("button",{disabled:D||_,className:"button button-primary",onClick:()=>(async()=>{await y(C),I(1)})()},(0,c.__)("Create","complianz-gdpr"),_&&(0,l.createElement)(i.default,{name:"loading",color:"grey"})))))),L>0&&(0,l.createElement)(l.Fragment,null,L<=O&&P.map(((e,t)=>(0,l.createElement)(o.default,{key:t,index:t,field:e,isCustomField:!0,customChangeHandler:(e,t)=>((e,t)=>{N(e,t)})(e,t)}))),L>O&&(0,l.createElement)(l.Fragment,null,(0,l.createElement)(s.default,null)),(0,l.createElement)("div",{className:"cmplz-table-header"},(0,l.createElement)("div",{className:"cmplz-table-header-controls"},(0,l.createElement)("button",{disabled:f,className:"button button-default",onClick:()=>{E(),I(0)}},L<=O&&(0,c.__)("Cancel","complianz-gdpr"),L>O&&(0,c.__)("Exit","complianz-gdpr")),L<=O&&(0,l.createElement)("button",{className:"button button-default",onClick:()=>I(L-1)},(0,c.__)("Previous","complianz-gdpr")),L<O&&(0,l.createElement)(l.Fragment,null,(0,l.createElement)("button",{className:"button button-primary",onClick:()=>I(L+1)},(0,c.__)("Next","complianz-gdpr"))),L===O&&(0,l.createElement)(l.Fragment,null,(0,l.createElement)("button",{className:"button button-primary",onClick:()=>(async()=>{await w(C),U(),I(L+1)})()},(0,c.__)("Finish","complianz-gdpr"),f&&(0,l.createElement)(i.default,{name:"loading",color:"grey"}))),L>O&&z&&z.has_to_be_reported&&(0,l.createElement)(l.Fragment,null,(0,l.createElement)("button",{disabled:R,className:"button button-primary",onClick:()=>H()},(0,c.__)("Download","complianz-gdpr"))),k&&L<O&&(0,l.createElement)(l.Fragment,null,(0,l.createElement)("button",{disabled:f,className:"button button-primary",onClick:()=>j()},(0,c.__)("Save","complianz-gdpr")))))))}))},59179:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var l=a(69307),n=a(39510),c=a(65736),o=a(56293),r=a(71655);const i=(0,a(99196).memo)((()=>{const{savedDocument:e,conclusions:t}=(0,n.default)(),{addHelpNotice:a}=(0,o.default)();return(0,l.useEffect)((()=>{e.has_to_be_reported&&a("create-data-breach-reports","warning",(0,c.__)("This wizard is intended to provide a general guide to a possible data breach.","complianz-gdpr")+" "+(0,c.__)("Specialist legal advice should be sought about your specific circumstances.","complianz-gdpr"),(0,c.__)("Specialist legal advice required","complianz-gdpr"),!1)}),[e]),(0,l.createElement)(l.Fragment,null,(0,l.createElement)("div",{id:"cmplz-conclusion"},(0,l.createElement)("h3",null,(0,c.__)("Your dataleak report:","complianz-gdpr")),(0,l.createElement)("ul",{className:"cmplz-conclusion__list"},t.length>0&&t.map(((e,t)=>(0,l.createElement)(r.default,{conclusion:e,key:t,delay:1e3*t}))))))}))},71655:(e,t,a)=>{a.r(t),a.d(t,{default:()=>c});var l=a(69307),n=a(43684);const c=(0,a(99196).memo)((e=>{let{conclusion:t,delay:a}=e;const[c,o]=(0,l.useState)(!0);(0,l.useEffect)((()=>{setTimeout((()=>{r()}),a)}));const r=()=>{o(!1)};let i="green";return"warning"===t.report_status&&(i="orange"),"error"===t.report_status&&(i="red"),(0,l.createElement)(l.Fragment,null,c&&(0,l.createElement)("li",{className:"cmplz-conclusion__check icon-loading"},(0,l.createElement)(n.default,{name:"loading",color:"grey"}),(0,l.createElement)("div",{className:"cmplz-conclusion__check--report-text"}," ",t.check_text," ")),!c&&(0,l.createElement)("li",{className:"cmplz-conclusion__check icon-"+t.report_status},(0,l.createElement)(n.default,{name:t.report_status,color:i}),(0,l.createElement)("div",{className:"cmplz-conclusion__check--report-text",dangerouslySetInnerHTML:{__html:t.report_text}})))}))},39510:(e,t,a)=>{a.r(t),a.d(t,{default:()=>r});var l=a(30270),n=a(12902),c=a(48399),o=a(75169);const r=(0,l.Ue)(((e,t)=>({documentsLoaded:!1,savedDocument:{},conclusions:[],region:"",fileName:"",fetching:!1,updating:!1,loadingFields:!1,documents:[],regions:[],fields:[],editDocumentId:!1,resetEditDocumentId:t=>{e({editDocumentId:!1,region:""})},editDocument:async(t,a)=>{t.preventDefault(),e({updating:!0}),await c.doAction("load_databreach_report",{id:a}).then((t=>{e({fields:t.fields,region:t.region,updating:!1,fileName:t.file_name})})).catch((e=>{console.error(e)})),e({editDocumentId:a})},setRegion:t=>{e({region:t})},updateField:(a,l)=>{let c=!1,r=!1;e((0,n.ZP)((e=>{e.fields.forEach((function(e,t){e.id===a&&(r=t,c=!0)})),!1!==r&&(e.fields[r].value=l)})));let i=(0,o.updateFieldsListWithConditions)(t().fields);e({fields:i})},save:async a=>{e({updating:!0});let l=t().editDocumentId,n=0;await c.doAction("save_databreach_report",{fields:t().fields,region:a,post_id:l}).then((t=>(n=t.post_id,e({updating:!1,conclusions:t.conclusions}),t))).catch((e=>{console.error(e)})),await t().fetchData();let o=t().documents.filter((e=>e.id===n));o.length>0&&e({savedDocument:o[0]})},deleteDocuments:async a=>{let l=t().documents.filter((e=>a.includes(e.id)));e((e=>({documents:e.documents.filter((e=>!a.includes(e.id)))})));let n={};n.documents=l,await c.doAction("delete_databreach_report",n).then((e=>e)).catch((e=>{console.error(e)}))},fetchData:async()=>{if(t().fetching)return;e({fetching:!0});const{documents:a,regions:l}=await c.doAction("get_databreach_reports",{}).then((e=>e)).catch((e=>{console.error(e)}));e((e=>({documentsLoaded:!0,documents:a,regions:l,fetching:!1})))},fetchFields:async t=>{let a={region:t};e({loadingFields:!0});const{fields:l}=await c.doAction("get_databreach_report_fields",a).then((e=>e)).catch((e=>{console.error(e)}));let n=(0,o.updateFieldsListWithConditions)(l);e((e=>({fields:n,loadingFields:!1})))}})))},32588:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var l=a(69307),n=a(99196),c=a(61592),o=a(43684),r=a(65736);const i=(0,n.memo)((e=>{let{value:t=!1,onChange:a,required:n,defaultValue:i,disabled:s,options:d={},innerRef:m}=e;return(0,l.createElement)("div",{className:"cmplz-input-group cmplz-select-group"},(0,l.createElement)(c.fC,{value:t,defaultValue:i,onValueChange:a,required:n,disabled:s&&!Array.isArray(s)},(0,l.createElement)(c.xz,{className:"cmplz-select-group__trigger"},(0,l.createElement)(c.B4,null),(0,l.createElement)(o.default,{name:"chevron-down"})),(0,l.createElement)(c.VY,{className:"cmplz-select-group__content",position:"popper"},(0,l.createElement)(c.u_,{className:"cmplz-select-group__scroll-button"},(0,l.createElement)(o.default,{name:"chevron-up"})),(0,l.createElement)(c.l_,{className:"cmplz-select-group__viewport"},(0,l.createElement)(c.ZA,null,(0,l.createElement)(c.ck,{className:"cmplz-select-group__item",key:0,value:""},(0,l.createElement)(c.eT,null,(0,r.__)("Select an option","complianz-gdpr"))),Object.entries(d).map((e=>{let[t,a]=e;return(0,l.createElement)(c.ck,{disabled:Array.isArray(s)&&s.includes(t),className:"cmplz-select-group__item",key:t,value:t},(0,l.createElement)(c.eT,null,a))})))),(0,l.createElement)(c.$G,{className:"cmplz-select-group__scroll-button"},(0,l.createElement)(o.default,{name:"chevron-down"})))))}))}}]);