"use strict";(self.webpackChunkcomplianz_gdpr=self.webpackChunkcomplianz_gdpr||[]).push([[3231,2640,881,382],{73231:(e,t,n)=>{n.r(t),n.d(t,{default:()=>l});var r=n(69307),a=n(65736),o=n(82640),c=n(99196),s=n(382);const l=(0,c.memo)((()=>{const e=10,[t,c]=(0,r.useState)({}),[l,d]=(0,r.useState)(!1),[i,u]=(0,r.useState)("ID"),[m,p]=(0,r.useState)("DESC"),[g,h]=(0,r.useState)(!1),[f,b]=(0,r.useState)(null),{records:_,searchValue:v,setSearchValue:E,deleteRecords:y,recordsLoaded:k,fetchData:N,resolveRecords:C,totalRecords:z,fetching:D}=(0,o.default)(),[I,S]=(0,r.useState)(""),[w,x]=(0,r.useState)([]),[O,R]=(0,r.useState)(null);(0,r.useEffect)((()=>{n.e(44).then(n.bind(n,90044)).then((e=>{let{default:t}=e;R((()=>t))}))}),[]),(0,r.useEffect)((()=>{k||N(e,1,i,m)}),[k]);const P=[{name:(0,r.createElement)(s.default,{options:{true:""},indeterminate:l,value:g,onChange:n=>(n=>{if(n){h(!0);let n=t.currentPage?t.currentPage:1,r=_.slice((n-1)*e,n*e);x(r.map((e=>e.ID)))}else h(!1),x([]);d(!1)})(n)}),selector:e=>e.selectControl,orderId:"select"},{name:(0,a.__)("User ID","complianz-gdpr"),selector:e=>e.ID,sortable:!0,orderId:"ID"},{name:(0,a.__)("Name","complianz-gdpr"),selector:e=>e.name,sortable:!0,orderId:"name"},{name:(0,a.__)("E-mail","complianz-gdpr"),selector:e=>e.email,sortable:!0,orderId:"email"},{name:(0,a.__)("Status","complianz-gdpr"),selector:e=>1==e.resolved?(0,a.__)("Resolved","complianz-gdpr"):(0,a.__)("Open","complianz-gdpr"),sortable:!0,orderId:"resolved"},{name:(0,a.__)("Region","complianz-gdpr"),selector:e=>e.region?(0,r.createElement)("img",{alt:"region",width:"20px",height:"20px",src:cmplz_settings.plugin_url+"assets/images/"+e.region+".svg"}):"",sortable:!0},{name:(0,a.__)("Date","complianz-gdpr"),selector:e=>e.request_date,sortable:!0},{name:(0,a.__)("Data Request","complianz-gdpr"),selector:e=>e.type?(0,r.createElement)("a",{target:"_blank",href:"https://complianz.io/"+e.type.slug},e.type.short):"",sortable:!0,orderId:"resolved",right:!0}];let A=[..._],T=[];return A.forEach((n=>{let a={...n};a.selectControl=(0,r.createElement)(s.default,{value:w.includes(a.ID),options:{true:""},onChange:n=>((n,r)=>{let a=[...w];n?a.includes(r)||(a.push(r),x(a)):(a=[...w.filter((e=>e!==r))],x(a));let o=t.currentPage?t.currentPage:1,c=_.slice((o-1)*e,o*e),s=!0,l=!1;c.forEach((e=>{a.includes(e.id)?l=!0:s=!1})),s?(h(!0),d(!1)):l?(h(!1),d(!0)):d(!1)})(n,a.ID)}),T.push(a)})),(0,r.createElement)(r.Fragment,null,(0,r.createElement)("div",{className:"cmplz-table-header"},(0,r.createElement)("div",{className:"cmplz-table-header-controls"},(0,r.createElement)("input",{className:"cmplz-datatable-search",type:"text",placeholder:(0,a.__)("Search","complianz-gdpr"),value:v,onChange:t=>(t=>{clearTimeout(f),E(t);const n=setTimeout((()=>{N(e,1,i,m)}),500);b(n)})(t.target.value)}))),w.length>0&&(0,r.createElement)("div",{className:"cmplz-selected-document"},w.length>1&&(0,a.__)("%s items selected","complianz-gdpr").replace("%s",w.length),1===w.length&&(0,a.__)("1 item selected","complianz-gdpr"),(0,r.createElement)("div",{className:"cmplz-selected-document-controls"},_.filter((e=>w.includes(e.ID)&&1!=e.resolved)).length>0&&(0,r.createElement)("button",{disabled:I,className:"button button-default",onClick:()=>C(w)},(0,a.__)("Mark as resolved","complianz-gdpr")),(0,r.createElement)("button",{className:"button button-default cmplz-reset-button",onClick:()=>(async e=>{x([]),await y(e)})(w)},(0,a.__)("Delete","complianz-gdpr")))),O&&(0,r.createElement)(r.Fragment,null,(0,r.createElement)(O,{columns:P,data:T,dense:!0,pagination:!0,paginationServer:!0,noDataComponent:(0,r.createElement)("div",{className:"cmplz-no-documents"},(0,a.__)("No records","really-simple-ssl")),persistTableHead:!0,theme:"really-simple-plugins",customStyles:{headCells:{style:{paddingLeft:"0",paddingRight:"0"}},cells:{style:{paddingLeft:"0",paddingRight:"0"}}},paginationPerPage:e,onChangePage:n=>{c({...t,currentPage:n}),N(e,t.currentPage,i,m)},paginationState:t,paginationTotalRows:z,onChangeRowsPerPage:async(e,n)=>{c({...t,currentPage:n}),N(e,n,i,m)},onSort:async(n,r)=>{u(n.orderId),p(r),N(e,t.currentPage,n.orderId,r)},sortServer:!0})))}))},82640:(e,t,n)=>{n.r(t),n.d(t,{default:()=>c});var r=n(30270),a=n(48399),o=n(12902);const c=(0,r.Ue)(((e,t)=>({recordsLoaded:!1,searchValue:"",setSearchValue:t=>e({searchValue:t}),fetching:!1,generating:!1,progress:!1,records:[],totalRecords:0,totalOpen:0,exportLink:"",noData:!1,deleteRecords:async n=>{let r=t().records.filter((e=>n.includes(e.ID)));e((e=>({records:e.records.filter((e=>!n.includes(e.ID)))})));let o={};o.records=r,await a.doAction("delete_datarequests",o).then((e=>e)).catch((e=>{console.error(e)}))},resolveRecords:async n=>{e((0,o.ZP)((e=>{e.records.forEach((function(t,r){n.includes(t.ID)&&(e.records[r].resolved=!0)}))})));let r={};r.records=t().records.filter((e=>n.includes(e.ID))),await a.doAction("resolve_datarequests",r).then((e=>e)).catch((e=>{console.error(e)}))},fetchData:async(n,r,o,c)=>{if(t().fetching)return;e({fetching:!0});let s={};s.per_page=n,s.page=r,s.order=c.toUpperCase(),s.orderBy=o,s.search=t().searchValue;const{records:l,totalRecords:d,totalOpen:i}=await a.doAction("get_datarequests",s).then((e=>e)).catch((e=>{console.error(e)}));e((()=>({recordsLoaded:!0,records:l,totalRecords:d,totalOpen:i,fetching:!1})))},startExport:async()=>{e({generating:!0,progress:0,exportLink:""})},fetchExportDatarequestsProgress:async(t,n,r)=>{(t=void 0!==t&&t)||e({generating:!0});let o={};o.startDate=n,o.endDate=r,o.statusOnly=t;const{progress:c,exportLink:s,noData:l}=await a.doAction("export_datarequests",o).then((e=>e)).catch((e=>{console.error(e)}));let d=!1;c<100&&(d=!0),e({progress:c,exportLink:s,generating:d,noData:l})}})))},80881:(e,t,n)=>{n.r(t),n.d(t,{default:()=>d});var r=n(69307),a=n(99196),o=n(48399),c=n(56293),s=n(82485),l=n(55609);const d=(0,a.memo)((e=>{let{type:t="action",style:n="tertiary",label:d,onClick:i,href:u="",target:m="",disabled:p,action:g,field:h,children:f}=e;if(!d&&!f)return null;const b=(h&&h.button_text?h.button_text:d)||f,{fetchFieldsData:_,showSavedSettingsNotice:v}=(0,c.default)(),{selectedSubMenuItem:E}=(0,s.default)(),[y,k]=(0,a.useState)(!1),N=`button cmplz-button button--${n} button-${t}`,C=async e=>{await o.doAction(h.action,{}).then((e=>{e.success&&(_(E),v(e.message))}))},z=h&&h.warn?h.warn:"";return"action"===t?(0,r.createElement)(r.Fragment,null,(0,r.createElement)(l.__experimentalConfirmDialog,{isOpen:y,onConfirm:async()=>{k(!1),await C()},onCancel:()=>{k(!1)}},z),(0,r.createElement)("button",{className:N,onClick:async e=>{"action"===t&&i?i(e):"action"===t&&g?h&&h.warn?k(!0):await C():window.location.href=h.url},disabled:p},b)):"link"===t?(0,r.createElement)("a",{className:N,href:u,target:m},b):void 0}))},382:(e,t,n)=>{n.r(t),n.d(t,{default:()=>S});var r=n(69307),a=n(87462),o=n(99196),c=n(28771),s=n(25360),l=n(36206),d=n(77342),i=n(57898),u=n(7546),m=n(29115),p=n(75320);const g="Checkbox",[h,f]=(0,s.b)(g),[b,_]=h(g),v=(0,o.forwardRef)(((e,t)=>{const{__scopeCheckbox:n,name:r,checked:s,defaultChecked:i,required:u,disabled:m,value:g="on",onCheckedChange:h,...f}=e,[_,v]=(0,o.useState)(null),N=(0,c.e)(t,(e=>v(e))),C=(0,o.useRef)(!1),z=!_||Boolean(_.closest("form")),[D=!1,I]=(0,d.T)({prop:s,defaultProp:i,onChange:h}),S=(0,o.useRef)(D);return(0,o.useEffect)((()=>{const e=null==_?void 0:_.form;if(e){const t=()=>I(S.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}}),[_,I]),(0,o.createElement)(b,{scope:n,state:D,disabled:m},(0,o.createElement)(p.WV.button,(0,a.Z)({type:"button",role:"checkbox","aria-checked":y(D)?"mixed":D,"aria-required":u,"data-state":k(D),"data-disabled":m?"":void 0,disabled:m,value:g},f,{ref:N,onKeyDown:(0,l.M)(e.onKeyDown,(e=>{"Enter"===e.key&&e.preventDefault()})),onClick:(0,l.M)(e.onClick,(e=>{I((e=>!!y(e)||!e)),z&&(C.current=e.isPropagationStopped(),C.current||e.stopPropagation())}))})),z&&(0,o.createElement)(E,{control:_,bubbles:!C.current,name:r,value:g,checked:D,required:u,disabled:m,style:{transform:"translateX(-100%)"}}))})),E=e=>{const{control:t,checked:n,bubbles:r=!0,...c}=e,s=(0,o.useRef)(null),l=(0,i.D)(n),d=(0,u.t)(t);return(0,o.useEffect)((()=>{const e=s.current,t=window.HTMLInputElement.prototype,a=Object.getOwnPropertyDescriptor(t,"checked").set;if(l!==n&&a){const t=new Event("click",{bubbles:r});e.indeterminate=y(n),a.call(e,!y(n)&&n),e.dispatchEvent(t)}}),[l,n,r]),(0,o.createElement)("input",(0,a.Z)({type:"checkbox","aria-hidden":!0,defaultChecked:!y(n)&&n},c,{tabIndex:-1,ref:s,style:{...e.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}}))};function y(e){return"indeterminate"===e}function k(e){return y(e)?"indeterminate":e?"checked":"unchecked"}const N=v,C=(0,o.forwardRef)(((e,t)=>{const{__scopeCheckbox:n,forceMount:r,...c}=e,s=_("CheckboxIndicator",n);return(0,o.createElement)(m.z,{present:r||y(s.state)||!0===s.state},(0,o.createElement)(p.WV.span,(0,a.Z)({"data-state":k(s.state),"data-disabled":s.disabled?"":void 0},c,{ref:t,style:{pointerEvents:"none",...e.style}})))}));var z=n(65736),D=n(20384),I=n(80881);const S=(0,o.memo)((e=>{let{indeterminate:t,label:n,value:a,id:c,onChange:s,required:l,disabled:d,options:i={}}=e,u=a;Array.isArray(u)||(u=""===u?[]:[u]),t&&(a=!0);const m=u,[p,g]=(0,o.useState)(!1);let h=!1;Object.keys(i).length>10&&(h=!0);const f=e=>m.includes(e),b=()=>{g(!p)};let _=d&&!Array.isArray(d);return(0,r.createElement)("div",{className:"cmplz-checkbox-group"},Object.entries(i).map(((e,o)=>{let[u,g]=e;return(0,r.createElement)("div",{key:u,className:"cmplz-checkbox-group__item"+(!p&&o>10?" cmplz-hidden":"")},(0,r.createElement)(N,{className:"cmplz-checkbox-group__checkbox",id:c+"_"+u,checked:1===Object.keys(i).length?a:f(u),"aria-label":n,disabled:_||Array.isArray(d)&&d.includes(u),required:l,onCheckedChange:e=>((e,t)=>{if(1===Object.keys(i).length)s(!a);else{const e=m.includes(t)?m.filter((e=>e!==t)):[...m,t];s(e)}})(0,u)},(0,r.createElement)(C,{className:"cmplz-checkbox-group__indicator"},(0,r.createElement)(D.default,{name:t?"indeterminate":"check",size:14,color:"dark-blue"}))),(0,r.createElement)("label",{className:"cmplz-checkbox-group__label",htmlFor:c+"_"+u},g))})),!p&&h&&(0,r.createElement)(I.default,{onClick:b},(0,z.__)("Show more","complianz-gdpr")),p&&h&&(0,r.createElement)(I.default,{onClick:b},(0,z.__)("Show less","complianz-gdpr")))}))},29115:(e,t,n)=>{n.d(t,{z:()=>s});var r=n(99196),a=n(91850),o=n(28771),c=n(9981);const s=e=>{const{present:t,children:n}=e,s=function(e){const[t,n]=(0,r.useState)(),o=(0,r.useRef)({}),s=(0,r.useRef)(e),d=(0,r.useRef)("none"),i=e?"mounted":"unmounted",[u,m]=function(e,t){return(0,r.useReducer)(((e,n)=>{const r=t[e][n];return null!=r?r:e}),e)}(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return(0,r.useEffect)((()=>{const e=l(o.current);d.current="mounted"===u?e:"none"}),[u]),(0,c.b)((()=>{const t=o.current,n=s.current;if(n!==e){const r=d.current,a=l(t);e?m("MOUNT"):"none"===a||"none"===(null==t?void 0:t.display)?m("UNMOUNT"):m(n&&r!==a?"ANIMATION_OUT":"UNMOUNT"),s.current=e}}),[e,m]),(0,c.b)((()=>{if(t){const e=e=>{const n=l(o.current).includes(e.animationName);e.target===t&&n&&(0,a.flushSync)((()=>m("ANIMATION_END")))},n=e=>{e.target===t&&(d.current=l(o.current))};return t.addEventListener("animationstart",n),t.addEventListener("animationcancel",e),t.addEventListener("animationend",e),()=>{t.removeEventListener("animationstart",n),t.removeEventListener("animationcancel",e),t.removeEventListener("animationend",e)}}m("ANIMATION_END")}),[t,m]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:(0,r.useCallback)((e=>{e&&(o.current=getComputedStyle(e)),n(e)}),[])}}(t),d="function"==typeof n?n({present:s.isPresent}):r.Children.only(n),i=(0,o.e)(s.ref,d.ref);return"function"==typeof n||s.isPresent?(0,r.cloneElement)(d,{ref:i}):null};function l(e){return(null==e?void 0:e.animationName)||"none"}s.displayName="Presence"},57898:(e,t,n)=>{n.d(t,{D:()=>a});var r=n(99196);function a(e){const t=(0,r.useRef)({value:e,previous:e});return(0,r.useMemo)((()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous)),[e])}}}]);