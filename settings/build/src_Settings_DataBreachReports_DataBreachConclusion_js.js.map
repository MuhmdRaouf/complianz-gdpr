{"version":3,"file":"src_Settings_DataBreachReports_DataBreachConclusion_js.js","mappings":"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","sources":["webpack://complianz-gdpr/./src/Settings/DataBreachReports/DataBreachConclusion.js","webpack://complianz-gdpr/./src/Settings/DataBreachReports/DataBreachConclusionItem.js","webpack://complianz-gdpr/./src/Settings/DataBreachReports/DataBreachReportsData.js"],"sourcesContent":["import useDataBreachReportsData from \"./DataBreachReportsData\";\nimport {useEffect} from \"@wordpress/element\";\nimport { __ } from '@wordpress/i18n';\nimport useFields from \"../Fields/FieldsData\";\nimport DataBreachConclusionItem from \"./DataBreachConclusionItem\";\nimport {memo} from \"react\";\n\nconst DataBreachConclusion = () => {\n\tconst {\n\t\tsavedDocument,\n\t\tconclusions,\n\t} = useDataBreachReportsData();\n\tconst { addHelpNotice} = useFields();\n\n\tuseEffect(() => {\n\t\tif  (savedDocument.has_to_be_reported ) {\n\t\t\taddHelpNotice('create-data-breach-reports', 'warning',\n\t\t\t\t__(\"This wizard is intended to provide a general guide to a possible data breach.\", \"complianz-gdpr\") + ' ' +\n\t\t\t\t__(\"Specialist legal advice should be sought about your specific circumstances.\", \"complianz-gdpr\"),\n\t\t\t\t__(\"Specialist legal advice required\", \"complianz-gdpr\"),\n\t\t\t\tfalse);\n\t\t}\n\t},[savedDocument]);\n\n\treturn (\n\t\t<>\n\t\t\t<div id=\"cmplz-conclusion\"><h3>{ __( \"Your dataleak report:\", 'complianz-gdpr' )}</h3>\n\t\t\t\t<ul className=\"cmplz-conclusion__list\">\n\t\t\t\t\t{ conclusions.length>0 && conclusions.map((conclusion, i) =>\n\t\t\t\t\t\t<DataBreachConclusionItem conclusion={conclusion} key={i} delay={i * 1000}/>\n\t\t\t\t\t)}\n\t\t\t</ul></div>\n\n\t\t</>\n\t)\n}\nexport default memo(DataBreachConclusion);\n","import {useState, useEffect} from \"@wordpress/element\";\nimport Icon from \"../../utils/Icon\";\nimport {memo} from \"react\";\n\nconst DataBreachConclusionItem = ({conclusion, delay}) => {\n\tconst [generating, setGenerating] = useState(true);\n\n\tuseEffect(() => {\n\t\tsetTimeout(() => {\n\t\t\tshow();\n\t\t}, delay);\n\t});\n\n\tconst show = () => {\n\t\tsetGenerating(false);\n\t}\n\n\tlet iconColor = 'green';\n\tif (conclusion.report_status==='warning') iconColor = 'orange';\n\tif (conclusion.report_status==='error') iconColor = 'red';\n\treturn (\n\n\t\t<>\n\t\t\t{generating &&\n\t\t\t\t<li className={\"cmplz-conclusion__check icon-loading\"}>\n\t\t\t\t\t<Icon name={'loading'} color={'grey'}/>\n\t\t\t\t\t<div className=\"cmplz-conclusion__check--report-text\"> { conclusion.check_text} </div>\n\t\t\t\t</li>\n\t\t\t}\n\t\t\t{!generating &&\n\t\t\t\t<li className={\"cmplz-conclusion__check icon-\"+conclusion.report_status}>\n\t\t\t\t\t<Icon name={conclusion.report_status} color={iconColor}/>\n\t\t\t\t\t<div className=\"cmplz-conclusion__check--report-text\" dangerouslySetInnerHTML={{__html:conclusion.report_text}}></div>\n\t\t\t\t</li>\n\t\t\t}\n\t\t</>\n\t)\n}\nexport default memo(DataBreachConclusionItem);\n","import {create} from 'zustand';\nimport produce from 'immer';\nimport * as cmplz_api from \"../../utils/api\";\nimport {updateFieldsListWithConditions} from \"../../utils/updateFieldsListWithConditions\";\n\nconst useDataBreachReportsData = create(( set, get ) => ({\n\tdocumentsLoaded: false,\n\tsavedDocument:{},\n\tconclusions:[],\n\tregion: '',\n\tfileName: '',\n\tfetching:false,\n\tupdating:false,\n\tloadingFields:false,\n\tdocuments: [],\n\tregions: [],\n\tfields: [],\n\teditDocumentId:false,\n\tresetEditDocumentId: (id) => {\n\t\tset({editDocumentId:false, region:''});\n\t},\n\teditDocument: async (e, id) => {\n\t\te.preventDefault();\n\t\tset({updating:true});\n\t\tawait cmplz_api.doAction('load_databreach_report', {id: id}).then((response) => {\n\t\t\tset({fields:response.fields,region:response.region,updating:false,fileName:response.file_name});\n\t\t}).catch((error) => {\n\t\t\tconsole.error(error);\n\t\t});\n\t\tset({editDocumentId:id});\n\t},\n\tsetRegion: (region) => {\n\t\tset({region:region});\n\t},\n\tupdateField: (id, value) => {\n\t\tlet found=false;\n\t\tlet index = false;\n\t\tset(\n\t\t\tproduce((state) => {\n\t\t\t\tstate.fields.forEach(function(fieldItem, i) {\n\t\t\t\t\tif (fieldItem.id === id ){\n\t\t\t\t\t\tindex = i;\n\t\t\t\t\t\tfound=true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (index!==false) state.fields[index].value = value;\n\t\t\t})\n\t\t)\n\t\tlet newFields = updateFieldsListWithConditions(get().fields);\n\t\tset({fields:newFields});\n\t},\n\tsave: async ( region ) => {\n\t\tset({updating:true});\n\t\tlet postId = get().editDocumentId;\n\t\tlet savedDocumentId = 0;\n\t\tawait cmplz_api.doAction('save_databreach_report', {fields: get().fields, region: region,post_id:postId}).then((response) => {\n\t\t\tsavedDocumentId = response.post_id;\n\t\t\tset({updating:false,conclusions:response.conclusions});\n\t\t\treturn response;\n\t\t}).catch((error) => {\n\t\t\tconsole.error(error);\n\t\t});\n\t\tawait get().fetchData();\n\t\tlet documents = get().documents;\n\t\tlet savedDocuments = documents.filter(document => document.id === savedDocumentId);\n\t\tif (savedDocuments.length>0) {\n\t\t\tset({savedDocument:savedDocuments[0]})\n\t\t}\n\n\t},\n\tdeleteDocuments: async ( ids ) => {\n\t\t//get array of documents to delete\n\t\tlet deleteDocuments = get().documents.filter(document => ids.includes(document.id));\n\t\t//remove the ids from the documents array\n\t\tset((state) => ({\n\t\t\tdocuments: state.documents.filter(document => !ids.includes(document.id)),\n\t\t}));\n\t\tlet data = {};\n\t\tdata.documents = deleteDocuments;\n\t\tawait cmplz_api.doAction('delete_databreach_report', data).then((response) => {\n\t\t\treturn response;\n\t\t}).catch((error) => {\n\t\t\tconsole.error(error);\n\t\t});\n\t},\n\tfetchData: async ( ) => {\n\t\tif (get().fetching) return;\n\t\tset({fetching:true});\n\t\tlet data = {}\n\t\tconst { documents,regions } = await cmplz_api.doAction('get_databreach_reports', data).then((response) => {\n\t\t\treturn response;\n\t\t}).catch((error) => {\n\t\t\tconsole.error(error);\n\t\t});\n\t\tset((state) => ({\n\t\t\tdocumentsLoaded: true,\n\t\t\tdocuments: documents,\n\t\t\tregions: regions,\n\t\t\tfetching:false,\n\t\t}));\n\t},\n\tfetchFields: async ( region ) => {\n\t\tlet data = {region:region}\n\t\tset({loadingFields:true});\n\t\tconst { fields } = await cmplz_api.doAction('get_databreach_report_fields', data).then((response) => {\n\t\t\treturn response;\n\t\t}).catch((error) => {\n\t\t\tconsole.error(error);\n\t\t});\n\t\tlet newFields = updateFieldsListWithConditions(fields);\n\t\tset((state) => ({\n\t\t\tfields: newFields,\n\t\t\tloadingFields:false,\n\t\t}));\n\t},\n}));\n\nexport default useDataBreachReportsData;\n"],"names":["useDataBreachReportsData","useEffect","__","useFields","DataBreachConclusionItem","memo","DataBreachConclusion","savedDocument","conclusions","addHelpNotice","has_to_be_reported","createElement","Fragment","id","className","length","map","conclusion","i","key","delay","useState","Icon","_ref","generating","setGenerating","setTimeout","show","iconColor","report_status","name","color","check_text","dangerouslySetInnerHTML","__html","report_text","create","produce","cmplz_api","updateFieldsListWithConditions","set","get","documentsLoaded","region","fileName","fetching","updating","loadingFields","documents","regions","fields","editDocumentId","resetEditDocumentId","editDocument","e","preventDefault","doAction","then","response","file_name","catch","error","console","setRegion","updateField","value","found","index","state","forEach","fieldItem","newFields","save","postId","savedDocumentId","post_id","fetchData","savedDocuments","filter","document","deleteDocuments","ids","includes","data","fetchFields"],"sourceRoot":""}