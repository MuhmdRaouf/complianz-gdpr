"use strict";(globalThis.webpackChunkcomplianz_gdpr=globalThis.webpackChunkcomplianz_gdpr||[]).push([[2870,5972],{72870:(e,t,n)=>{n.r(t),n.d(t,{default:()=>a});var r=n(69307),l=n(56293),c=n(5830),s=n(37839),o=n(75972);const a=()=>{const e=(0,r.useRef)(null),{fields:t,updateField:n,getFieldValue:a,getField:i,setChangedField:p}=(0,l.default)(),{setBannerContainerClass:u,bannerContainerClass:d,cssLoading:m,cssLoaded:f,generatePreviewCss:y,pageLinks:g,selectedBanner:z,selectedBannerId:_,fetchBannerData:S,bannerDataLoaded:b,bannerHtml:v,manageConsentHtml:h,consentType:k,vendorCount:q,setBannerFieldsSynced:w}=(0,c.default)(),[x,E]=(0,r.useState)(null),[L,P]=(0,r.useState)(!1),[T,A]=(0,r.useState)(!1),[C,I]=(0,r.useState)(!1);(0,r.useEffect)((()=>{let e="tcf"===a("uses_ad_cookies_personalized")||"yes"===a("uses_ad_cookies_personalized");A(e)}),[t]),(0,r.useEffect)((()=>{b||S()}),[b]),(0,r.useEffect)((()=>{S()}),[a("a_b_testing_buttons")]),(0,s.Z)((()=>{M()})),(0,r.useEffect)((()=>{b&&(n("consent_type",k),p("consent_type",k))}),[k]),(0,r.useEffect)((()=>{if(b){let e=B();for(const t of e)if(z.hasOwnProperty(t.id)){let e=z[t.id];(0===e.length||e.hasOwnProperty("text")&&0===e.text.length)&&(e=t.default),n(t.id,e)}n("manage_consent",z.revoke),P(!0)}}),[_,b]),(0,r.useEffect)((()=>{(async()=>{L&&!m&&(n("consent_type",k),await O(),"optin"===k&&D()&&await O(),1==a("soft_cookiewall")&&(u("cmplz-soft-cookiewall"),setTimeout((function(){u("")}),4e3)),H(!0))})()}),[t,k,_,L]);const O=()=>{clearTimeout(x);let e=B();if(C){const t=setTimeout((()=>{y(e)}),500);E(t)}else y(e),I(!0)};(0,r.useEffect)((()=>{if(console.log("banner data tcf"),!T)return;console.log("banner data tcf 2");const t=e.current;if(e.current&&(console.log("banner data tcf 3"),"optin"===k&&t)){console.log("banner data tcf 4");let e=i("tcf_purposes"),n=(0,o.filterArray)(e.options,e.value);const r=(0,o.getPurposes)("marketing",!1),l=(0,o.getPurposes)("statistics",!1),c=(0,o.filterArray)(n,r),s=(0,o.filterArray)(n,l);console.log("marketingPurposes"),console.log(c);let a=i("tcf_features"),p=(0,o.filterArray)(a.options,a.value),u=i("tcf_specialFeatures"),d=(0,o.filterArray)(u.options,u.value),m=i("tcf_specialPurposes"),f=(0,o.filterArray)(m.options,m.value);const y=t.querySelector(".cmplz-tcf .cmplz-marketing .cmplz-description"),g=t.querySelector(".cmplz-tcf .cmplz-statistics .cmplz-description"),z=t.querySelector(".cmplz-tcf .cmplz-features .cmplz-description"),_=t.querySelector(".cmplz-tcf .cmplz-specialfeatures .cmplz-title"),S=t.querySelector(".cmplz-tcf .cmplz-specialpurposes .cmplz-title");let b=t.querySelector(".cmplz-tcf .cmplz-features"),v=t.querySelector(".cmplz-tcf .cmplz-specialpurposes"),h=t.querySelector(".cmplz-tcf .cmplz-specialfeatures"),k=t.querySelector(".cmplz-tcf .cmplz-statistics");0===p.length&&b&&(b.style.display="none"),0===f.length&&v&&(v.style.display="none"),0===d.length&&h&&(h.style.display="none"),0===s.length&&k&&(k.style.display="none"),y&&(y.innerHTML=(0,o.concatenateString)(c)),g&&(g.innerHTML=(0,o.concatenateString)(s)),z&&(z.innerHTML=(0,o.concatenateString)(p)),_&&(_.innerHTML=(0,o.concatenateString)(d)),S&&(S.innerHTML=(0,o.concatenateString)(f))}}),[T,L,b,k,m,t]),(0,r.useEffect)((()=>{if(L){let e=B();for(const t of e)z.hasOwnProperty(t.id)&&(z[t.id]=t.value);w(!0)}}),[t]);const F=(e,t,n)=>{let r=new RegExp(t,"g");return e.replace(r,n)},H=e=>{let t=document.querySelector(".cmplz-manage-consent"),n=document.querySelector("#cmplz-cookiebanner-container .cmplz-cookiebanner");t&&(t.style.display="none"),n&&e&&(n.querySelector(".cmplz-view-preferences").style.display="block",n.querySelector(".cmplz-save-preferences").style.display="none"),document.addEventListener("click",(e=>{e.target.closest(".cmplz-manage-consent")&&(n.style.display="block",t&&(t.style.display="none")),(e.target.closest(".cmplz-close")||e.target.closest(".cmplz-accept")||e.target.closest(".cmplz-deny"))&&(n.style.display="none",t&&(t.style.display="block")),e.target.closest(".cmplz-view-preferences")&&(n.classList.add("cmplz-categories-visible"),n.querySelector(".cmplz-categories").style.display="block",n.querySelector(".cmplz-categories").classList.add("cmplz-fade-in"),n.querySelector(".cmplz-view-preferences").style.display="none",n.querySelector(".cmplz-save-preferences").style.display="block"),e.target.closest(".cmplz-save-preferences")&&(n.classList.remove("cmplz-categories-visible"),n.querySelector(".cmplz-categories").style.display="none",n.querySelector(".cmplz-categories").classList.remove("cmplz-fade-in"),n.querySelector(".cmplz-view-preferences").style.display="block",n.querySelector(".cmplz-save-preferences").style.display="none")}))},M=()=>{let e=document.querySelector("#cmplz-cookiebanner-container");e&&e.querySelectorAll(".cmplz-links a:not(.cmplz-external), .cmplz-buttons a:not(.cmplz-external)").forEach((e=>{e.classList.add("cmplz-hidden");for(let n in g)g.hasOwnProperty(n)&&e.classList.contains(n)&&(e.setAttribute("href",g[n].url+e.getAttribute("data-relative_url")),"{title}"===e.innerText&&(e.innerText=(t=g[n].title,(new DOMParser).parseFromString(t,"text/html").documentElement.textContent)),e.classList.remove("cmplz-hidden"));var t})),H(!1)},B=()=>t.filter((e=>"banner"===e.data_target)),D=()=>{if("bottom"===a("position"))return!1;if(!0===a("disable_width_correction"))return!1;if(!document.querySelector(".cmplz-categories"))return;document.querySelector(".cmplz-categories").style.display="block";let e=document.querySelector(".cmplz-categories").offsetWidth;document.querySelector(".cmplz-categories").style.display="none";let t=document.querySelector(".cmplz-message").offsetWidth,r=document.querySelector(".cmplz-cookiebanner").offsetWidth,l=1.3*r,c=0,s=0,o=!1,i=window.getComputedStyle(document.querySelector(".cmplz-cookiebanner"),null).getPropertyValue("padding-left"),p=window.getComputedStyle(document.querySelector(".cmplz-cookiebanner"),null).getPropertyValue("padding-left");if(-1!==i.indexOf("px")&&-1!==p.indexOf("px")&&(o=parseInt(i.replace("px",""))+parseInt(p.replace("px",""))),e>0&&o&&r-o>e){let t=r-42-e;c=parseInt(r)+parseInt(t)}let u=0;if(u=document.querySelectorAll(".cmplz-buttons .cmplz-btn").offsetWidth,u>t){let e=u-42-t;s=parseInt(u)+parseInt(e)}let d=0;return d=s>c?s:c,d>r&&d<l&&(d%2!=0&&d++,n("banner_width",d),!0)},W=e=>{let t={use_logo:"logo",category_all:"category_marketing",category_stats:"category_statistics",accept_informational:"accept_optout",accept:"accept_optin",view_preferences:"manage_options",save_preferences:"save_settings"};return t.hasOwnProperty(e)?t[e]:e};if(!b)return(0,r.createElement)(r.Fragment,null);let R=v,V=h,j=B();R=F(R,"{consent_type}",k),R=F(R,"{id}",z.ID),R=F(R,"{vendor_count}",q),V=F(V,"{id}",z.ID);let Z=1==a("hide_preview")||1==a("disable_cookiebanner");for(const e of j){if("title"===e.id)continue;let t=W(e.id);if(z.hasOwnProperty(e.id)){let n=z[e.id];R="text_checkbox"===e.type&&n&&n.hasOwnProperty("text")?F(R,"{"+t+"}",n.text):"banner_logo"===e.type?F(R,"{"+t+"}",z.logo_options[n]?z.logo_options[n]:""):F(R,"{"+t+"}",n)}"revoke"===e.id&&(V=F(V,"{manage_consent}",z.revoke))}return!f||Z?(0,r.createElement)(r.Fragment,null):(0,r.createElement)(r.Fragment,null,(0,r.createElement)("div",{id:"cmplz-preview-banner-container",ref:e},(0,r.createElement)("div",{id:"cmplz-cookiebanner-container",className:d,dangerouslySetInnerHTML:{__html:R}}),(0,r.createElement)("div",{id:"cmplz-manage-consent","data-nosnippet":"true",dangerouslySetInnerHTML:{__html:V}})))}},75972:(e,t,n)=>{n.r(t),n.d(t,{concatenateString:()=>c,filterArray:()=>l,getPurposes:()=>r});const r=(e,t)=>"functional"===e||"preferences"===e?[]:"marketing"===e?t?[1,2,3,4,5,6,7,8,9,10]:[1,2,3,4,5,6,10]:"statistics"===e?[1,7,8,9]:void 0,l=(e,t)=>{e||(e={}),Array.isArray(t)||(t=Object.keys(e));const n=t.map((e=>parseInt(e)));return Object.keys(e).filter((e=>n.includes(parseInt(e)))).map((t=>e[t]))},c=e=>{let t="";const n=e.length-1;for(var r in e)e.hasOwnProperty(r)&&(t+=e[r],t+=r<n?", ":".");return t}},37839:(e,t,n)=>{n.d(t,{Z:()=>l});var r=n(99196);const l=function(e,t){var n,l=(n=(0,r.useRef)(!0)).current?(n.current=!1,!0):n.current;(0,r.useEffect)((function(){if(!l)return e()}),t)}}}]);