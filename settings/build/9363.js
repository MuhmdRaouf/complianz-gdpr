"use strict";(globalThis.webpackChunkcomplianz_gdpr=globalThis.webpackChunkcomplianz_gdpr||[]).push([[9363,2588,5294,7853,3667],{32588:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(69307),l=a(99196),c=a(61592),r=a(43684),o=a(65736);const i=(0,l.memo)((e=>{let{value:t=!1,onChange:a,required:l,defaultValue:i,disabled:s,options:d={},innerRef:m}=e;return(0,n.createElement)("div",{className:"cmplz-input-group cmplz-select-group"},(0,n.createElement)(c.fC,{value:t,defaultValue:i,onValueChange:a,required:l,disabled:s&&!Array.isArray(s)},(0,n.createElement)(c.xz,{className:"cmplz-select-group__trigger"},(0,n.createElement)(c.B4,null),(0,n.createElement)(r.default,{name:"chevron-down"})),(0,n.createElement)(c.VY,{className:"cmplz-select-group__content",position:"popper"},(0,n.createElement)(c.u_,{className:"cmplz-select-group__scroll-button"},(0,n.createElement)(r.default,{name:"chevron-up"})),(0,n.createElement)(c.l_,{className:"cmplz-select-group__viewport"},(0,n.createElement)(c.ZA,null,(0,n.createElement)(c.ck,{className:"cmplz-select-group__item",key:0,value:""},(0,n.createElement)(c.eT,null,(0,o.__)("Select an option","complianz-gdpr"))),Object.entries(d).map((e=>{let[t,a]=e;return(0,n.createElement)(c.ck,{disabled:Array.isArray(s)&&s.includes(t),className:"cmplz-select-group__item",key:t,value:t},(0,n.createElement)(c.eT,null,a))})))),(0,n.createElement)(c.$G,{className:"cmplz-select-group__scroll-button"},(0,n.createElement)(r.default,{name:"chevron-down"})))))}))},65294:(e,t,a)=>{a.r(t),a.d(t,{default:()=>c});var n=a(69307),l=a(99196);const c=(0,l.memo)((e=>{let{value:t,onChange:a,required:c,defaultValue:r,disabled:o,id:i,name:s,placeholder:d}=e;const m=i||s,[u,p]=(0,l.useState)("");return(0,l.useEffect)((()=>{p(t||"")}),[t]),(0,l.useEffect)((()=>{const e=setTimeout((()=>{a(u)}),500);return()=>{clearTimeout(e)}}),[u]),(0,n.createElement)("div",{className:"cmplz-input-group cmplz-text-input-group"},(0,n.createElement)("input",{type:"text",id:m,name:s,value:u,onChange:e=>(e=>{p(e)})(e.target.value),required:c,disabled:o,className:"cmplz-text-input-group__input",placeholder:d}))}))},9363:(e,t,a)=>{a.r(t),a.d(t,{default:()=>f});var n=a(69307),l=a(17853),c=a(65736),r=a(55609),o=a(93019),i=a(56293),s=a(43684),d=a(43667),m=a(99196),u=a(32588),p=a(65294),g=a(63801);const f=(0,m.memo)((()=>{const{fields:e,fileName:t,fetching:a,loadingFields:m,updating:f,regions:_,resetEditDocumentId:b,fetchData:E,fetchFields:h,updateField:v,save:z,editDocumentId:N,region:y,setRegion:C,serviceName:k,setServiceName:F}=(0,l.default)(),[w,S]=(0,n.useState)(!0),[D,A]=(0,n.useState)(0),{allRequiredFieldsCompleted:x,fetchAllFieldsCompleted:I,fieldsLoaded:q,addHelpNotice:T,showSavedSettingsNotice:R,removeHelpNotice:V}=(0,i.default)();let L=React.createRef();const[P,H]=(0,n.useState)(!1),[U,W]=(0,n.useState)(!1),[Y,j]=(0,n.useState)(!0);(0,n.useEffect)((()=>{N&&L.current&&L.current.scrollIntoView({behavior:"smooth",block:"start"})}),[N]),(0,n.useEffect)((()=>{I()}),[q]),(0,n.useEffect)((()=>{S(""===y||""===k)}),[y,k,a,N]),(0,n.useEffect)((()=>{(async()=>{P&&("application/pdf"!==P.type&&"application/doc"!==P.type&&"application/docx"!==P.type?(j(!0),T("create-processing-agreements","warning",(0,c.__)("You can only upload .pdf, .doc or .docs files","complianz-gdpr"),(0,c.__)("Incorrect extension","complianz-gdpr"),!1)):(j(!1),V("create-processing-agreements")),P&&S(!0))})()}),[P]);const M=async()=>{await z(y,k),R()};(0,n.useEffect)((()=>{""===y||""===k||a||S(!1)}),[y,k,a]);let O=e.filter((e=>e=>void 0===e.conditionallyDisabled||!1===e.conditionallyDisabled)),Z=Math.ceil(O.length/5),B=(e=>{const t=5*(D-1),a=t+5;return e.slice(t,a)})(e);return(0,n.createElement)(n.Fragment,null,!x&&(0,n.createElement)("div",{className:"cmplz-locked"},(0,n.createElement)("div",{className:"cmplz-locked-overlay"},(0,n.createElement)("span",{className:"cmplz-task-status cmplz-warning"},(0,c.__)("Incomplete","complianz-gdpr")),(0,n.createElement)("span",null,(0,c.__)("The wizard has not been completed yet, but this field requires information from the wizard. Please complete the wizard first.","complianz-gdpr")))),0===D&&(0,n.createElement)(n.Fragment,null,N&&(0,n.createElement)("div",{className:"cmplz-selected-document"},t),(0,n.createElement)(g.default,{id:"region_for_processing_agreement",label:(0,c.__)("Region","complianz-gdpr"),required:!0,type:"select"}),(0,n.createElement)(u.default,{innerRef:L,disabled:f,onChange:e=>C(e),options:_,value:y,required:!0}),(0,n.createElement)(g.default,{id:"servicename_for_processing_agreement",label:(0,c.__)("Service name","complianz-gdpr"),required:!0,type:"text"}),(0,n.createElement)(p.default,{placeholder:(0,c.__)("e.g. Marketing Agency","complianz-gdpr"),onChange:e=>F(e),value:k||"",disabled:f,required:!0}),(0,n.createElement)("div",{className:"cmplz-table-header"},(0,n.createElement)("div",{className:"cmplz-table-header-controls"},N&&(0,n.createElement)(n.Fragment,null,(0,n.createElement)("button",{disabled:f,className:"button button-default",onClick:()=>{b(),A(0)}},(0,c.__)("Cancel","complianz-gdpr")),(0,n.createElement)("button",{disabled:f,className:"button button-primary",onClick:()=>A(D+1)},(0,c.__)("Next","complianz-gdpr")),(0,n.createElement)("button",{disabled:f,className:"button button-primary",onClick:()=>M()},(0,c.__)("Save","complianz-gdpr"))),!N&&(0,n.createElement)(n.Fragment,null,P&&P.name,(0,n.createElement)(r.FormFileUpload,{accept:"",icon:(0,n.createElement)(s.default,{name:"upload",color:"black"}),onChange:e=>H(e.currentTarget.files[0])},(0,c.__)("Select file","complianz-gdpr")),(0,n.createElement)("button",{disabled:Y,className:"button button-default",onClick:e=>(j(!0),W(!0),void(0,d.upload)("upload_processing_agreement",P,{region:y,serviceName:k}).then((e=>(e.data.upload_success?R((0,c.__)("Settings imported","complianz-gdpr")):T("import_settings","warning",(0,c.__)("You can only upload .json files","complianz-gdpr"),(0,c.__)("Incorrect extension","complianz-gdpr"),!1),W(!1),H(!1),b(),E(),!0))).catch((e=>{console.error(e)})))},(0,c.__)("Upload","complianz-gdpr"),U&&(0,n.createElement)(s.default,{name:"loading",color:"grey"})),(0,n.createElement)("button",{disabled:w||m,className:"button cmplz-button button-primary",onClick:()=>(async()=>{await h(y),A(1)})()},(0,c.__)("Create","complianz-gdpr"),m&&(0,n.createElement)(s.default,{name:"loading",color:"grey"})))))),D>0&&(0,n.createElement)(n.Fragment,null,D<=Z&&B.map(((e,t)=>(0,n.createElement)(o.default,{key:t,index:t,field:e,isCustomField:!0,customChangeHandler:(e,t)=>((e,t)=>{v(e,t)})(e,t)}))),(0,n.createElement)("div",{className:"cmplz-table-header"},(0,n.createElement)("div",{className:"cmplz-table-header-controls"},(0,n.createElement)("button",{disabled:f,className:"button button-default",onClick:()=>{b(),A(0)}},(0,c.__)("Cancel","complianz-gdpr")),(0,n.createElement)("button",{className:"button button-default",onClick:()=>A(D-1)},(0,c.__)("Previous","complianz-gdpr")),D<Z&&(0,n.createElement)(n.Fragment,null,(0,n.createElement)("button",{className:"button button-primary",onClick:()=>A(D+1)},(0,c.__)("Next","complianz-gdpr"))),D===Z&&(0,n.createElement)(n.Fragment,null,(0,n.createElement)("button",{className:"button button-primary",onClick:()=>(async()=>{await z(y,k),A(0),R(),b()})()},(0,c.__)("Finish","complianz-gdpr"),f&&(0,n.createElement)(s.default,{name:"loading",color:"grey"}))),N&&D<Z&&(0,n.createElement)(n.Fragment,null,(0,n.createElement)("button",{disabled:f,className:"button button-primary",onClick:()=>M()},(0,c.__)("Save","complianz-gdpr")))))))}))},17853:(e,t,a)=>{a.r(t),a.d(t,{default:()=>o});var n=a(30270),l=a(12902),c=a(48399),r=a(75169);const o=(0,n.Ue)(((e,t)=>({documentsLoaded:!1,region:"",fileName:"",serviceName:"",fetching:!1,updating:!1,loadingFields:!1,documents:[],regions:[],fields:[],editDocumentId:!1,resetEditDocumentId:t=>{e({editDocumentId:!1,region:"",serviceName:""})},editDocument:async(t,a)=>{t.preventDefault(),e({updating:!0}),await c.doAction("load_processing_agreement",{id:a}).then((t=>{e({fields:t.fields,region:t.region,serviceName:t.serviceName,updating:!1,fileName:t.file_name})})).catch((e=>{console.error(e)})),e({editDocumentId:a})},setRegion:t=>{e({region:t})},setServiceName:t=>{e({serviceName:t})},updateField:(a,n)=>{let c=!1,o=!1;e((0,l.ZP)((e=>{e.fields.forEach((function(e,t){e.id===a&&(o=t,c=!0)})),!1!==o&&(e.fields[o].value=n)})));let i=(0,r.updateFieldsListWithConditions)(t().fields);e({fields:i})},save:async(a,n)=>{e({updating:!0});let l=t().editDocumentId;await c.doAction("save_processing_agreement",{fields:t().fields,region:a,serviceName:n,post_id:l}).then((t=>(e({updating:!1}),t))).catch((e=>{console.error(e)})),t().fetchData()},deleteDocuments:async a=>{let n=t().documents.filter((e=>a.includes(e.id)));e((e=>({documents:e.documents.filter((e=>!a.includes(e.id)))})));let l={};l.documents=n,await c.doAction("delete_processing_agreement",l).then((e=>e)).catch((e=>{console.error(e)}))},fetchData:async()=>{if(t().fetching)return;e({fetching:!0});const{documents:a,regions:n}=await c.doAction("get_processing_agreements",{}).then((e=>e)).catch((e=>{console.error(e)}));e((()=>({documentsLoaded:!0,documents:a,regions:n,fetching:!1})))},fetchFields:async t=>{let a={region:t};e({loadingFields:!0});const{fields:n}=await c.doAction("get_processing_agreement_fields",a).then((e=>e)).catch((e=>{console.error(e)}));let l=(0,r.updateFieldsListWithConditions)(n);e((e=>({fields:l,loadingFields:!1})))}})))},43667:(e,t,a)=>{a.r(t),a.d(t,{upload:()=>c});var n=a(9669),l=a.n(n);const c=(e,t,a)=>{let n=new FormData;return n.append("data",t),void 0!==a&&n.append("details",JSON.stringify(a)),l().post(cmplz_settings.admin_url+"?page=complianz&cmplz_upload_file=1&action="+e,n,{headers:{"Content-Type":"multipart/form-data","X-WP-Nonce":cmplz_settings.nonce}})}}}]);