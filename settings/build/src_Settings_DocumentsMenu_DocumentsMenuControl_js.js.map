{"version":3,"file":"src_Settings_DocumentsMenu_DocumentsMenuControl_js.js","mappings":"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","sources":["webpack://complianz-gdpr/./src/Settings/DocumentsMenu/DocumentsMenuControl.js","webpack://complianz-gdpr/./src/Settings/DocumentsMenu/MenuData.js","webpack://complianz-gdpr/./src/Settings/DocumentsMenu/MenuPerDocument.js","webpack://complianz-gdpr/./src/Settings/DocumentsMenu/MenuPerDocumentType.js","webpack://complianz-gdpr/./src/Settings/DocumentsMenu/SingleDocumentMenuControl.js"],"sourcesContent":["import { __ } from '@wordpress/i18n';\nimport {useEffect} from \"@wordpress/element\";\nimport useFields from \"../../Settings/Fields/FieldsData\";\nimport {UseMenuData} from \"./MenuData\";\nimport MenuPerDocument from \"./MenuPerDocument\";\nimport MenuPerDocumentType from \"./MenuPerDocumentType\";\nimport Placeholder from '../../Placeholder/Placeholder';\nimport SingleDocumentMenuControl from \"./SingleDocumentMenuControl\";\nimport {memo, useState} from \"react\";\n\n/**\n * Render a help notice in the sidebar\n */\nconst DocumentsMenuControl = (props) => {\n\tconst {pageTypes, menuDataLoaded, fetchMenuData, menu, emptyMenuLink, genericDocuments, createdDocuments, documentsNotInMenu, regions } = UseMenuData();\n\tconst { getFieldValue, addHelpNotice, documentSettingsChanged, setDocumentSettingsChanged} = useFields();\n\tconst [isRegionRedirected, setIsRegionRedirected] = useState(false);\n\n\tuseEffect ( () => {\n\t\tif (!menuDataLoaded || documentSettingsChanged) {\n\t\t\tsetDocumentSettingsChanged(false);\n\t\t\tfetchMenuData();\n\t\t}\n\t}, [documentSettingsChanged])\n\n\tuseEffect( () => {\n\t\tsetIsRegionRedirected(getFieldValue('region_redirect')==='yes');\n\t},[getFieldValue('region_redirect')])\n\n\tuseEffect ( () => {\n\t\tif (!menuDataLoaded) {\n\t\t\treturn;\n\t\t}\n\t\tlet text = '';\n\t\tlet title = '';\n\t\tlet field_id = isRegionRedirected ? 'add_pages_to_menu_region_redirected' : 'add_pages_to_menu';\n\t\tif ( menu.length===0 ) {\n\t\t\ttitle = __(\"No menus found.\",\"complianz-gdpr\");\n\t\t\ttext = __(\"No menus were found. Skip this step, or create a menu first.\",\"complianz-gdpr\");\n\t\t\taddHelpNotice( field_id, 'warning', text, title, emptyMenuLink);\n\t\t} else if ( documentsNotInMenu.length>0 ) {\n\t\t\ttitle = __(\"Missing pages.\",\"complianz-gdpr\");\n\t\t\tif (documentsNotInMenu.length===1) {\n\t\t\t\tlet document = documentsNotInMenu[0];\n\t\t\t\ttext = __( 'The generated document %s has not been assigned to a menu yet, you can do this now, or skip this step and do it later.','complianz-gdpr').replace('%s',document);\n\t\t\t} else {\n\t\t\t\ttext = __( 'Not all generated documents have been assigned to a menu yet, you can do this now, or skip this step and do it later.','complianz-gdpr');\n\t\t\t}\n\t\t\taddHelpNotice( field_id, 'warning', text, title, false );\n\t\t} else if ( documentsNotInMenu.length===0 ) {\n\t\t\ttitle = __(\"All pages generated!\",\"complianz-gdpr\");\n\t\t\ttext = __('Great! All your generated documents have been assigned to a menu, so you can skip this step.', 'complianz-gdpr');\n\t\t\taddHelpNotice( field_id, 'warning', text, title, false );\n\t\t}\n\n\t}, [menuDataLoaded, documentsNotInMenu, menu])\n\n\tif ( !menuDataLoaded ) {\n\t\treturn (\n\t\t\t<Placeholder lines=\"3\"></Placeholder>\n\t\t)\n\t}\n\n\tif (!isRegionRedirected) {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t{ regions.map((region,i) =>\n\t\t\t\t\t<MenuPerDocument key={i} region={region}/>\n\t\t\t\t)}\n\t\t\t</>\n\n\t\t);\n\t} else {\n\t\t//get all documents which can't be region redirected\n\t\tlet nonRedirectingGenericDocuments = genericDocuments.filter(doc =>!doc.can_region_redirect);\n\t\tlet nonRedirectingDocuments = [];\n\t\tnonRedirectingGenericDocuments.forEach(function(nonRedirectingGenericDoc, i){\n\t\t\tlet docs = createdDocuments.filter(doc => nonRedirectingGenericDoc.type === doc.type );\n\t\t\tif (docs.length>0){\n\t\t\t\tnonRedirectingDocuments.push(docs[0]);\n\t\t\t}\n\t\t})\n\n\t\treturn (\n\t\t\t<>\n\t\t\t\t{pageTypes.map((type,i) =>\n\t\t\t\t\t<MenuPerDocumentType key={i} pageType={type}/>\n\t\t\t\t)}\n\t\t\t\t{ nonRedirectingDocuments.map( (document, i)=> <SingleDocumentMenuControl key={i} document={document}/> )}\n\t\t\t</>\n\t\t);\n\t}\n}\nexport default memo(DocumentsMenuControl)\n","import {create} from 'zustand';\nimport * as cmplz_api from \"../../utils/api\";\nimport produce from \"immer\";\nimport {toast} from \"react-toastify\";\nimport {__} from '@wordpress/i18n';\n\nexport const UseMenuData = create(( set, get ) => ({\n\tmenuDataLoaded: false,\n\tsaving: false,\n\tmenu: [],\n\tmenuChanged:false,\n\tchangedMenuType:'per_document',\n\temptyMenuLink:'#',\n\trequiredDocuments:[],\n\tcreatedDocuments:[],\n\tgenericDocuments:[],\n\tdocumentsNotInMenu:[],\n\tpageTypes:[],\n\tregions:[],\n\tfetchMenuData: async () => {\n\t\tconst response = await fetchMenuData(false);\n\t\tlet createdDocuments = response.required_documents.filter( document => document.page_id );\n\n\t\tset({\n\t\t\tmenuDataLoaded:true,\n\t\t\temptyMenuLink: response.empty_menu_link,\n\t\t\tmenu: response.menu,\n\t\t\trequiredDocuments: response.required_documents,\n\t\t\tgenericDocuments: response.generic_documents_list,\n\t\t\tcreatedDocuments: createdDocuments,\n\t\t\tpageTypes: response.page_types,\n\t\t\tdocumentsNotInMenu: response.documents_not_in_menu,\n\t\t\tregions: response.regions,\n\t\t});\n\t},\n\tupdateMenu: (page_id, menu_id) => {\n\t\tlet menuType = isNaN(page_id) ? 'per_type' : 'per_document';\n\t\tset({ menuType:menuType });\n\t\tif (menuType==='per_type') {\n\t\t\tset(\n\t\t\t\tproduce((state) => {\n\t\t\t\t\tlet genIndex = state.genericDocuments.findIndex(function(page, i) {\n\t\t\t\t\t\treturn page.page_id === page_id || page.type === page_id;\n\t\t\t\t\t});\n\t\t\t\t\tlet createdIndex = state.createdDocuments.findIndex(function(page, i) {\n\t\t\t\t\t\treturn page.page_id === page_id || page.type === page_id;\n\t\t\t\t\t});\n\t\t\t\t\tif ( genIndex!==-1 ) {\n\t\t\t\t\t\tstate.genericDocuments[genIndex].menu_id = menu_id;\n\t\t\t\t\t\tif (createdIndex!==-1) state.createdDocuments[createdIndex].menu_id = -1;\n\t\t\t\t\t\tstate.menuChanged = true;\n\t\t\t\t\t}\n\n\t\t\t\t})\n\t\t\t)\n\t\t} else {\n\t\t\tset(\n\t\t\t\tproduce((state) => {\n\t\t\t\t\tlet genIndex = state.genericDocuments.findIndex(function(page, i) {\n\t\t\t\t\t\treturn page.page_id === page_id || page.type === page_id;\n\t\t\t\t\t});\n\t\t\t\t\tlet createdIndex = state.createdDocuments.findIndex(function(page, i) {\n\t\t\t\t\t\treturn page.page_id === page_id || page.type === page_id;\n\t\t\t\t\t});;\n\t\t\t\t\tif ( createdIndex!==-1 ) {\n\t\t\t\t\t\tstate.createdDocuments[createdIndex].menu_id = menu_id;\n\t\t\t\t\t\tif (genIndex!==-1) state.genericDocuments[genIndex].menu_id = -1;\n\t\t\t\t\t\tstate.menuChanged = true;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t)\n\t\t}\n\t},\n\tsaveDocumentsMenu: async (hasChangedFields, showNotice) => {\n\t\tset({saving:true });\n\t\tlet menuChanged = get().menuChanged;\n\t\tif ( menuChanged || hasChangedFields ) {\n\t\t\tlet data = {};\n\t\t\t//post for generic documents only the redirected ones.\n\t\t\tdata.genericDocuments = get().genericDocuments.filter(document => document.can_region_redirect);\n\t\t\tdata.createdDocuments = get().createdDocuments;\n\t\t\tconst response = cmplz_api.doAction('save_documents_menu_data', data).then((response) => {\n\t\t\t\tset({saving:false });\n\t\t\t\treturn response;\n\t\t\t}).catch((error) => {\n\t\t\t\tconsole.error(error);\n\t\t\t});\n\t\t\tshowNotice && toast.promise(\n\t\t\t\tresponse,\n\t\t\t\t{\n\t\t\t\t\tpending: __('Saving menu...', 'complianz-gdpr'),\n\t\t\t\t\tsuccess: __('Menu saved', 'complianz-gdpr'),\n\t\t\t\t\terror: __('Something went wrong', 'complianz-gdpr'),\n\t\t\t\t}\n\t\t\t);\n\t\t} else {\n\t\t\tshowNotice && toast.info(__('Settings have not been changed','complianz-gdpr'));\n\t\t}\n\n\t},\n}));\n\nconst fetchMenuData = () => {\n\tlet data = {};\n\tdata.generate = false;\n\treturn cmplz_api.doAction('documents_menu_data', data).then((response) => {\n\t\treturn response;\n\t}).catch((error) => {\n\t\tconsole.error(error);\n\t});\n}\n\n\n\n","import {UseMenuData} from \"./MenuData\";\nimport SingleDocumentMenuControl from \"./SingleDocumentMenuControl\";\nimport {memo} from \"react\";\n\nconst MenuPerDocument = (props) => {\n\tconst {createdDocuments} = UseMenuData();\n\t//filter out this region from the documents\n\tlet regionDocuments = createdDocuments.filter( document => document.region === props.region.id );\n\tif ( regionDocuments.length===0 ) {\n\t\treturn <></>\n\t}\n\n\treturn (\n\t\t<div>\n\t\t\t<h3 className=\"cmplz-h4\">{ props.region.label }</h3>\n\t\t\t{ regionDocuments.map( (document, i)=> <SingleDocumentMenuControl key={i} document={document}/> )}\n\t\t</div>\n\t)\n\n}\nexport default memo(MenuPerDocument)\n","import {UseMenuData} from \"./MenuData\";\nimport SingleDocumentMenuControl from \"./SingleDocumentMenuControl\";\nimport {memo} from \"react\";\n\nconst MenuPerDocumentType = (props) => {\n\tconst {genericDocuments } = UseMenuData();\n\t// filter out this region from the documents\n\tlet typeDocuments = genericDocuments.filter( document => document.type === props.pageType.type );\n\tif ( typeDocuments.length===0 ) {\n\t\treturn <></>\n\t}\n\n\treturn (\n\t\t<div>\n\t\t\t<h3 className=\"cmplz-h4\">{ props.type }</h3>\n\t\t\t{ typeDocuments.map( (document, i)=> <SingleDocumentMenuControl key={i} document={document}/> )}\n\t\t</div>\n\t)\n\n}\nexport default memo(MenuPerDocumentType)\n","import {UseMenuData} from \"./MenuData\";\nimport { __ } from '@wordpress/i18n';\nimport {memo} from \"react\";\n\nconst SingleDocumentMenuControl = (props) => {\n\tconst { menu, updateMenu } = UseMenuData();\n\tconst onChangeHandler = (e) => {\n\t\tupdateMenu(props.document.page_id, e.target.value);\n\t}\n\n\treturn (\n\t\t<div className=\"cmplz-single-document-menu\">\n\t\t\t<div className=\"cmplz-document-menu-title\">{props.document.title}</div>\n\t\t\t<select value={props.document.menu_id} onChange={(e) => onChangeHandler(e)}>\n\t\t\t\t<option value={-1} key={-1}>{__(\"Select a menu\",\"complianz-gdpr\")}</option>\n\t\t\t\t{menu.map( (menuItem, i)=> <option key={i} value={menuItem.id}>{menuItem.label}</option> )}\n\t\t\t</select>\n\t\t</div>\n\t)\n\n}\nexport default memo(SingleDocumentMenuControl)\n"],"names":["__","useEffect","useFields","UseMenuData","MenuPerDocument","MenuPerDocumentType","Placeholder","SingleDocumentMenuControl","memo","useState","DocumentsMenuControl","props","pageTypes","menuDataLoaded","fetchMenuData","menu","emptyMenuLink","genericDocuments","createdDocuments","documentsNotInMenu","regions","getFieldValue","addHelpNotice","documentSettingsChanged","setDocumentSettingsChanged","isRegionRedirected","setIsRegionRedirected","text","title","field_id","length","document","replace","createElement","lines","Fragment","map","region","i","key","nonRedirectingGenericDocuments","filter","doc","can_region_redirect","nonRedirectingDocuments","forEach","nonRedirectingGenericDoc","docs","type","push","pageType","create","cmplz_api","produce","toast","set","get","saving","menuChanged","changedMenuType","requiredDocuments","response","required_documents","page_id","empty_menu_link","generic_documents_list","page_types","documents_not_in_menu","updateMenu","menu_id","menuType","isNaN","state","genIndex","findIndex","page","createdIndex","saveDocumentsMenu","hasChangedFields","showNotice","data","doAction","then","catch","error","console","promise","pending","success","info","generate","regionDocuments","id","className","label","typeDocuments","onChangeHandler","e","target","value","onChange","menuItem"],"sourceRoot":""}