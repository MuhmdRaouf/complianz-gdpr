{"version":3,"file":"src_Settings_Export_ImportControl_js.js","mappings":"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","sources":["webpack://complianz-gdpr/./src/Settings/Export/ImportControl.js","webpack://complianz-gdpr/./src/utils/upload.js","webpack://complianz-gdpr/./src/Settings/Export/Import.scss?2511"],"sourcesContent":["import {\n\tFormFileUpload,\n} from '@wordpress/components';\nimport {useState, useEffect} from \"@wordpress/element\";\nimport useFields from \"../../Settings/Fields/FieldsData\";\nimport Icon from \"../../utils/Icon\";\nimport { __ } from '@wordpress/i18n';\nimport {upload} from \"../../utils/upload\";\nimport {memo} from \"react\";\nimport './Import.scss';\n\nfunction ImportControl() {\n\tconst {removeHelpNotice, addHelpNotice, showSavedSettingsNotice} = useFields();\n\tconst [file, setFile] = useState(false)\n\tconst [disabled, setDisabled] = useState(true);\n\tconst [uploading, setUploading] = useState(false);\n\tuseEffect(() => {\n\t\tif (!file ) return;\n\t\tif (file.type!=='application/json') {\n\t\t\tsetDisabled(true);\n\t\t\taddHelpNotice('import_settings', 'warning', __(\"You can only upload .json files\",\"complianz-gdpr\"), __(\"Incorrect extension\",\"complianz-gdpr\"),false);\n\t\t} else {\n\t\t\tsetDisabled(false);\n\t\t\tremoveHelpNotice('import_settings');\n\t\t}\n\n\t}, [file])\n\n\tconst onClickHandler = (e) => {\n\t\tsetDisabled(true);\n\t\tsetUploading(true);\n\n\t\tupload('import_settings', file).then((response) => {\n\t\t\tif (response.data.success) {\n\t\t\t\tshowSavedSettingsNotice(__(\"Settings imported\", \"complianz-gdpr\"));\n\t\t\t} else {\n\t\t\t\taddHelpNotice('import_settings', 'warning', __(\"You can only upload .json files\",\"complianz-gdpr\"), __(\"Incorrect extension\",\"complianz-gdpr\"),false);\n\t\t\t}\n\t\t\tsetUploading(false);\n\t\t\tsetFile(false);\n\t\t\treturn true;\n\t\t}).catch((error) => {\n\t\t\tconsole.error(error);\n\t\t});\n\t}\n\n\treturn (\n\t\t<div className=\"cmplz-import-form\">\n\t\t\t<div className=\"cmplz-import-button-container\">\n\t\t\t{file && file.name}\n\t\t\t<FormFileUpload\n\t\t\t\taccept=\"\"\n\t\t\t\ticon={ <Icon name=\"upload\" color = 'black' /> } //formfile upload overrides size prop. We override that in the icon component\n\t\t\t\tonChange={ ( event ) => setFile(event.currentTarget.files[0]) }\n\t\t\t>\n\t\t\t\t{__(\"Select file\",\"complianz-gdpr\")}\n\t\t\t</FormFileUpload>\n\t\t\t<button disabled={disabled} className=\"button button-default\"  onClick={(e) => onClickHandler(e)}>\n\t\t\t\t{__(\"Import\",\"complianz-gdpr\")}\n\t\t\t\t{uploading && <Icon name = \"loading\" color = 'grey' />}\n\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nexport default memo(ImportControl)\n","import axios from 'axios';\n\nexport const upload = (action, file, details) => {\n\tlet formData = new FormData();\n\tformData.append(\"data\", file);\n\tif ( typeof details !== 'undefined' ){\n\t\tformData.append(\"details\", JSON.stringify(details));\n\t}\n\treturn axios.post(cmplz_settings.admin_url+'?page=complianz&cmplz_upload_file=1&action='+action, formData, {\n\t\theaders: {\n\t\t\t\"Content-Type\": \"multipart/form-data\",\n\t\t\t'X-WP-Nonce': cmplz_settings.nonce,\n\t\t},\n\t});\n}\n","// extracted by mini-css-extract-plugin\nexport {};"],"names":["FormFileUpload","useState","useEffect","useFields","Icon","__","upload","memo","ImportControl","removeHelpNotice","addHelpNotice","showSavedSettingsNotice","file","setFile","disabled","setDisabled","uploading","setUploading","type","onClickHandler","e","then","response","data","success","catch","error","console","createElement","className","name","accept","icon","color","onChange","event","currentTarget","files","onClick","axios","action","details","formData","FormData","append","JSON","stringify","post","cmplz_settings","admin_url","headers","nonce"],"sourceRoot":""}