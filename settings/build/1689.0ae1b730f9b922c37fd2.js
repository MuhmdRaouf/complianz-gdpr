"use strict";(self.webpackChunkcomplianz_gdpr=self.webpackChunkcomplianz_gdpr||[]).push([[1689,8667,161],{18667:(e,t,a)=>{a.r(t),a.d(t,{default:()=>d,useDate:()=>l});var n=a(30270),r=a(49546),o=a(69119),s=a(7069),c=a(83894);const l=(0,n.Ue)((e=>({startDate:(0,r.default)((0,o.default)((0,s.Z)(new Date,7)),"yyyy-MM-dd"),setStartDate:t=>e((e=>({startDate:t}))),endDate:(0,r.default)((0,c.default)((0,s.Z)(new Date,1)),"yyyy-MM-dd"),setEndDate:t=>e((e=>({endDate:t}))),range:"last-7-days",setRange:t=>e((e=>({range:t})))}))),d=l},51689:(e,t,a)=>{a.r(t),a.d(t,{default:()=>l});var n=a(69307),r=a(65736),o=a(80161),s=a(20384),c=a(18667);const l=(0,a(99196).memo)((()=>{const{noData:e,startExport:t,exportLink:l,fetchExportRecordsOfConsentProgress:d,generating:i,progress:u}=(0,o.default)(),[f,p]=(0,n.useState)(null),{startDate:g,endDate:m}=(0,c.default)();return(0,n.useEffect)((()=>{Promise.all([a.e(5543),a.e(1165),a.e(6717)]).then(a.bind(a,6717)).then((e=>{let{default:t}=e;p((()=>t))}))}),[]),(0,n.useEffect)((()=>{d(!0)}),[]),(0,n.useEffect)((()=>{u<100&&i&&d(!1,g,m)}),[u]),(0,n.createElement)(n.Fragment,null,(0,n.createElement)("div",{className:"cmplz-field-button cmplz-table-header"},(0,n.createElement)("div",{className:"cmplz-table-header-controls"},f&&(0,n.createElement)(f,null),(0,n.createElement)("button",{disabled:i,className:"button button-default cmplz-field-button",onClick:()=>t()},(0,r.__)("Export to CSV","complianz-gdpr"),i&&(0,n.createElement)(n.Fragment,null,(0,n.createElement)(s.default,{name:"loading",color:"grey"}),"Â ",u,"%")))),u>=100&&(""!==l||e)&&(0,n.createElement)("div",{className:"cmplz-selected-document"},!e&&(0,r.__)("Your Records Of Consent Export has been completed.","complianz-gdpr"),e&&(0,r.__)("Your selection does not contain any data.","complianz-gdpr"),(0,n.createElement)("div",{className:"cmplz-selected-document-controls"},!e&&(0,n.createElement)("a",{className:"button button-default",download:!0,href:l},(0,r.__)("Download","complianz-gdpr")))))}))},80161:(e,t,a)=>{a.r(t),a.d(t,{default:()=>o});var n=a(30270),r=a(48399);const o=(0,n.Ue)(((e,t)=>({recordsLoaded:!1,fetching:!1,generating:!1,progress:!1,records:[],exportLink:"",downloadUrl:"",regions:[],fields:[],noData:!1,deleteRecords:async a=>{let n=t().records.filter((e=>a.includes(e.id)));e((e=>({records:e.records.filter((e=>!a.includes(e.id)))})));let o={};o.records=n,await r.doAction("delete_records_of_consent",o).then((e=>e)).catch((e=>{console.error(e)}))},fetchData:async()=>{if(t().fetching)return;e({fetching:!0});const{records:a,regions:n,download_url:o}=await r.doAction("get_records_of_consent",{}).then((e=>e)).catch((e=>{console.error(e)}));e((()=>({recordsLoaded:!0,records:a,regions:n,downloadUrl:o,fetching:!1})))},startExport:async()=>{e({generating:!0,progress:0,exportLink:""})},fetchExportRecordsOfConsentProgress:async(t,a,n)=>{(t=void 0!==t&&t)||e({generating:!0});let o={};o.startDate=a,o.endDate=n,o.statusOnly=t;const{progress:s,exportLink:c,noData:l}=await r.doAction("export_records_of_consent",o).then((e=>e)).catch((e=>{console.error(e)}));let d=!1;s<100&&(d=!0),e({progress:s,exportLink:c,generating:d,noData:l})}})))}}]);