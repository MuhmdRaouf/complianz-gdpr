"use strict";(self.webpackChunkcomplianz_gdpr=self.webpackChunkcomplianz_gdpr||[]).push([[3231,2175,2640,881,382],{32175:function(e,t,n){n.r(t),n.d(t,{UseCookieScanData:function(){return o}});var r=n(30270),a=n(48399);const o=(0,r.Ue)(((e,t)=>({initialLoadCompleted:!1,setInitialLoadCompleted:t=>e({initialLoadCompleted:t}),iframeLoaded:!1,loading:!1,nextPage:!1,progress:0,cookies:[],lastLoadedIframe:"",setIframeLoaded:t=>e({iframeLoaded:t}),setLastLoadedIframe:t=>e((e=>({lastLoadedIframe:t}))),setProgress:t=>e({progress:t}),fetchProgress:()=>(e({loading:!0}),a.doAction("get_scan_progress",{}).then((t=>(e({initialLoadCompleted:!0,loading:!1,nextPage:t.next_page,progress:t.progress,cookies:t.cookies}),t))))})))},73231:function(e,t,n){n.r(t);var r=n(69307),a=n(65736),o=n(82640),s=n(99196),c=n(382);t.default=(0,s.memo)((()=>{const e=10,[t,s]=(0,r.useState)({}),[l,i]=(0,r.useState)(!1),[d,u]=(0,r.useState)("ID"),[m,p]=(0,r.useState)("DESC"),[g,f]=(0,r.useState)(!1),[h,b]=(0,r.useState)(null),{records:_,searchValue:v,setSearchValue:E,deleteRecords:k,recordsLoaded:y,fetchData:C,resolveRecords:I,totalRecords:N,fetching:D}=(0,o.default)(),[z,S]=(0,r.useState)(""),[L,x]=(0,r.useState)([]),[w,P]=(0,r.useState)(null);(0,r.useEffect)((()=>{n.e(44).then(n.bind(n,90044)).then((e=>{let{default:t}=e;P((()=>t))}))}),[]),(0,r.useEffect)((()=>{y||C(e,1,d,m)}),[y]);const O=[{name:(0,r.createElement)(c.default,{options:{true:""},indeterminate:l,value:g,onChange:n=>(n=>{if(n){f(!0);let n=t.currentPage?t.currentPage:1,r=_.slice((n-1)*e,n*e);x(r.map((e=>e.ID)))}else f(!1),x([]);i(!1)})(n)}),selector:e=>e.selectControl,orderId:"select"},{name:(0,a.__)("User ID","complianz-gdpr"),selector:e=>e.ID,sortable:!0,orderId:"ID"},{name:(0,a.__)("Name","complianz-gdpr"),selector:e=>e.name,sortable:!0,orderId:"name"},{name:(0,a.__)("E-mail","complianz-gdpr"),selector:e=>e.email,sortable:!0,orderId:"email"},{name:(0,a.__)("Status","complianz-gdpr"),selector:e=>1==e.resolved?(0,a.__)("Resolved","complianz-gdpr"):(0,a.__)("Open","complianz-gdpr"),sortable:!0,orderId:"resolved"},{name:(0,a.__)("Region","complianz-gdpr"),selector:e=>e.region?(0,r.createElement)("img",{alt:"region",width:"20px",height:"20px",src:cmplz_settings.plugin_url+"assets/images/"+e.region+".svg"}):"",sortable:!0},{name:(0,a.__)("Date","complianz-gdpr"),selector:e=>e.request_date,sortable:!0},{name:(0,a.__)("Data Request","complianz-gdpr"),selector:e=>e.type?(0,r.createElement)("a",{target:"_blank",href:"https://complianz.io/"+e.type.slug},e.type.short):"",sortable:!0,orderId:"resolved",right:!0}];let R=[..._],A=[];return R.forEach((n=>{let a={...n};a.selectControl=(0,r.createElement)(c.default,{value:L.includes(a.ID),options:{true:""},onChange:n=>((n,r)=>{let a=[...L];n?a.includes(r)||(a.push(r),x(a)):(a=[...L.filter((e=>e!==r))],x(a));let o=t.currentPage?t.currentPage:1,s=_.slice((o-1)*e,o*e),c=!0,l=!1;s.forEach((e=>{a.includes(e.ID)?l=!0:c=!1})),c?(f(!0),i(!1)):l?(f(!1),i(!0)):i(!1)})(n,a.ID)}),A.push(a)})),(0,r.createElement)(r.Fragment,null,(0,r.createElement)("div",{className:"cmplz-table-header"},(0,r.createElement)("div",{className:"cmplz-table-header-controls"},(0,r.createElement)("input",{className:"cmplz-datatable-search",type:"text",placeholder:(0,a.__)("Search","complianz-gdpr"),value:v,onChange:t=>(t=>{clearTimeout(h),E(t);const n=setTimeout((()=>{C(e,1,d,m)}),500);b(n)})(t.target.value)}))),L.length>0&&(0,r.createElement)("div",{className:"cmplz-selected-document"},L.length>1&&(0,a.__)("%s items selected","complianz-gdpr").replace("%s",L.length),1===L.length&&(0,a.__)("1 item selected","complianz-gdpr"),(0,r.createElement)("div",{className:"cmplz-selected-document-controls"},_.filter((e=>L.includes(e.ID)&&1!=e.resolved)).length>0&&(0,r.createElement)("button",{disabled:z,className:"button button-default",onClick:()=>I(L)},(0,a.__)("Mark as resolved","complianz-gdpr")),(0,r.createElement)("button",{className:"button button-default cmplz-reset-button",onClick:()=>(async e=>{x([]),await k(e)})(L)},(0,a.__)("Delete","complianz-gdpr")))),w&&(0,r.createElement)(r.Fragment,null,(0,r.createElement)(w,{columns:O,data:A,dense:!0,pagination:!0,paginationServer:!0,noDataComponent:(0,r.createElement)("div",{className:"cmplz-no-documents"},(0,a.__)("No records","really-simple-ssl")),persistTableHead:!0,theme:"really-simple-plugins",customStyles:{headCells:{style:{paddingLeft:"0",paddingRight:"0"}},cells:{style:{paddingLeft:"0",paddingRight:"0"}}},paginationPerPage:e,onChangePage:n=>{s({...t,currentPage:n}),C(e,t.currentPage,d,m)},paginationState:t,paginationTotalRows:N,onChangeRowsPerPage:async(e,n)=>{s({...t,currentPage:n}),C(e,n,d,m)},onSort:async(n,r)=>{u(n.orderId),p(r),C(e,t.currentPage,n.orderId,r)},sortServer:!0})))}))},82640:function(e,t,n){n.r(t);var r=n(30270),a=n(48399),o=n(12902);const s=(0,r.Ue)(((e,t)=>({recordsLoaded:!1,searchValue:"",setSearchValue:t=>e({searchValue:t}),fetching:!1,generating:!1,progress:!1,records:[],totalRecords:0,totalOpen:0,exportLink:"",noData:!1,deleteRecords:async n=>{let r=t().records.filter((e=>n.includes(e.ID)));e((e=>({records:e.records.filter((e=>!n.includes(e.ID)))})));let o={};o.records=r,await a.doAction("delete_datarequests",o).then((e=>e)).catch((e=>{console.error(e)}))},resolveRecords:async n=>{e((0,o.ZP)((e=>{e.records.forEach((function(t,r){n.includes(t.ID)&&(e.records[r].resolved=!0)}))})));let r={};r.records=t().records.filter((e=>n.includes(e.ID))),await a.doAction("resolve_datarequests",r).then((e=>e)).catch((e=>{console.error(e)}))},fetchData:async(n,r,o,s)=>{if(t().fetching)return;e({fetching:!0});let c={};c.per_page=n,c.page=r,c.order=s.toUpperCase(),c.orderBy=o,c.search=t().searchValue;const{records:l,totalRecords:i,totalOpen:d}=await a.doAction("get_datarequests",c).then((e=>e)).catch((e=>{console.error(e)}));e((()=>({recordsLoaded:!0,records:l,totalRecords:i,totalOpen:d,fetching:!1})))},startExport:async()=>{e({generating:!0,progress:0,exportLink:""})},fetchExportDatarequestsProgress:async(t,n,r)=>{(t=void 0!==t&&t)||e({generating:!0});let o={};o.startDate=n,o.endDate=r,o.statusOnly=t;const{progress:s,exportLink:c,noData:l}=await a.doAction("export_datarequests",o).then((e=>e)).catch((e=>{console.error(e)}));let i=!1;s<100&&(i=!0),e({progress:s,exportLink:c,generating:i,noData:l})}})));t.default=s},80881:function(e,t,n){n.r(t);var r=n(69307),a=n(99196),o=n(48399),s=n(56293),c=n(82485),l=n(55609),i=n(32175),d=n(82387);t.default=(0,a.memo)((e=>{let{type:t="action",style:n="tertiary",label:u,onClick:m,href:p="",target:g="",disabled:f,action:h,field:b,children:_}=e;if(!u&&!_)return null;const v=(b&&b.button_text?b.button_text:u)||_,{fetchFieldsData:E,showSavedSettingsNotice:k}=(0,s.default)(),{setInitialLoadCompleted:y,setProgress:C}=(0,i.UseCookieScanData)(),{setProgressLoaded:I}=(0,d.default)(),{selectedSubMenuItem:N}=(0,c.default)(),[D,z]=(0,a.useState)(!1),S=`button cmplz-button button--${n} button-${t}`,L=async e=>{await o.doAction(b.action,{}).then((e=>{e.success&&(E(N),"reset_settings"===e.id&&(y(!1),C(0),I(!1)),k(e.message))}))},x=b&&b.warn?b.warn:"";return"action"===t?(0,r.createElement)(r.Fragment,null,(0,r.createElement)(l.__experimentalConfirmDialog,{isOpen:D,onConfirm:async()=>{z(!1),await L()},onCancel:()=>{z(!1)}},x),(0,r.createElement)("button",{className:S,onClick:async e=>{"action"===t&&m?m(e):"action"===t&&h?b&&b.warn?z(!0):await L():window.location.href=b.url},disabled:f},v)):"link"===t?(0,r.createElement)("a",{className:S,href:p,target:g},v):void 0}))},382:function(e,t,n){n.r(t),n.d(t,{default:function(){return S}});var r=n(69307),a=n(87462),o=n(99196),s=n(28771),c=n(25360),l=n(36206),i=n(77342),d=n(57898),u=n(7546),m=n(29115),p=n(75320);const g="Checkbox",[f,h]=(0,c.b)(g),[b,_]=f(g),v=(0,o.forwardRef)(((e,t)=>{const{__scopeCheckbox:n,name:r,checked:c,defaultChecked:d,required:u,disabled:m,value:g="on",onCheckedChange:f,...h}=e,[_,v]=(0,o.useState)(null),C=(0,s.e)(t,(e=>v(e))),I=(0,o.useRef)(!1),N=!_||Boolean(_.closest("form")),[D=!1,z]=(0,i.T)({prop:c,defaultProp:d,onChange:f}),S=(0,o.useRef)(D);return(0,o.useEffect)((()=>{const e=null==_?void 0:_.form;if(e){const t=()=>z(S.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}}),[_,z]),(0,o.createElement)(b,{scope:n,state:D,disabled:m},(0,o.createElement)(p.WV.button,(0,a.Z)({type:"button",role:"checkbox","aria-checked":k(D)?"mixed":D,"aria-required":u,"data-state":y(D),"data-disabled":m?"":void 0,disabled:m,value:g},h,{ref:C,onKeyDown:(0,l.M)(e.onKeyDown,(e=>{"Enter"===e.key&&e.preventDefault()})),onClick:(0,l.M)(e.onClick,(e=>{z((e=>!!k(e)||!e)),N&&(I.current=e.isPropagationStopped(),I.current||e.stopPropagation())}))})),N&&(0,o.createElement)(E,{control:_,bubbles:!I.current,name:r,value:g,checked:D,required:u,disabled:m,style:{transform:"translateX(-100%)"}}))})),E=e=>{const{control:t,checked:n,bubbles:r=!0,...s}=e,c=(0,o.useRef)(null),l=(0,d.D)(n),i=(0,u.t)(t);return(0,o.useEffect)((()=>{const e=c.current,t=window.HTMLInputElement.prototype,a=Object.getOwnPropertyDescriptor(t,"checked").set;if(l!==n&&a){const t=new Event("click",{bubbles:r});e.indeterminate=k(n),a.call(e,!k(n)&&n),e.dispatchEvent(t)}}),[l,n,r]),(0,o.createElement)("input",(0,a.Z)({type:"checkbox","aria-hidden":!0,defaultChecked:!k(n)&&n},s,{tabIndex:-1,ref:c,style:{...e.style,...i,position:"absolute",pointerEvents:"none",opacity:0,margin:0}}))};function k(e){return"indeterminate"===e}function y(e){return k(e)?"indeterminate":e?"checked":"unchecked"}const C=v,I=(0,o.forwardRef)(((e,t)=>{const{__scopeCheckbox:n,forceMount:r,...s}=e,c=_("CheckboxIndicator",n);return(0,o.createElement)(m.z,{present:r||k(c.state)||!0===c.state},(0,o.createElement)(p.WV.span,(0,a.Z)({"data-state":y(c.state),"data-disabled":c.disabled?"":void 0},s,{ref:t,style:{pointerEvents:"none",...e.style}})))}));var N=n(65736),D=n(23361),z=n(80881),S=(0,o.memo)((e=>{let{indeterminate:t,label:n,value:a,id:s,onChange:c,required:l,disabled:i,options:d={}}=e;const[u,m]=(0,o.useState)(!1);let p=a;Array.isArray(p)||(p=""===p?[]:[p]),(0,o.useEffect)((()=>{let e=1===Object.keys(d).length&&"true"===Object.keys(d)[0];m(e)}),[]),t&&(a=!0);const g=p,[f,h]=(0,o.useState)(!1);let b=!1;Object.keys(d).length>10&&(b=!0);const _=e=>u?a:g.includes(""+e)||g.includes(parseInt(e)),v=()=>{h(!f)};let E=i&&!Array.isArray(i);return 0===d.length?(0,r.createElement)(r.Fragment,null,(0,N.__)("No options found","complianz-gdpr")):(0,r.createElement)("div",{className:"cmplz-checkbox-group"},Object.entries(d).map(((e,o)=>{let[d,m]=e;return(0,r.createElement)("div",{key:d,className:"cmplz-checkbox-group__item"+(!f&&o>10?" cmplz-hidden":"")},(0,r.createElement)(C,{className:"cmplz-checkbox-group__checkbox",id:s+"_"+d,checked:_(d),"aria-label":n,disabled:E||Array.isArray(i)&&i.includes(d),required:l,onCheckedChange:e=>((e,t)=>{if(u)c(!a);else{const e=g.includes(""+t)||g.includes(parseInt(t))?g.filter((e=>e!==""+t&&e!==parseInt(t))):[...g,t];c(e)}})(0,d)},(0,r.createElement)(I,{className:"cmplz-checkbox-group__indicator"},(0,r.createElement)(D.default,{name:t?"indeterminate":"check",size:14,color:"dark-blue"}))),(0,r.createElement)("label",{className:"cmplz-checkbox-group__label",htmlFor:s+"_"+d},m))})),!f&&b&&(0,r.createElement)(z.default,{onClick:v},(0,N.__)("Show more","complianz-gdpr")),f&&b&&(0,r.createElement)(z.default,{onClick:v},(0,N.__)("Show less","complianz-gdpr")))}))},29115:function(e,t,n){n.d(t,{z:function(){return c}});var r=n(99196),a=n(91850),o=n(28771),s=n(9981);const c=e=>{const{present:t,children:n}=e,c=function(e){const[t,n]=(0,r.useState)(),o=(0,r.useRef)({}),c=(0,r.useRef)(e),i=(0,r.useRef)("none"),d=e?"mounted":"unmounted",[u,m]=function(e,t){return(0,r.useReducer)(((e,n)=>{const r=t[e][n];return null!=r?r:e}),e)}(d,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return(0,r.useEffect)((()=>{const e=l(o.current);i.current="mounted"===u?e:"none"}),[u]),(0,s.b)((()=>{const t=o.current,n=c.current;if(n!==e){const r=i.current,a=l(t);e?m("MOUNT"):"none"===a||"none"===(null==t?void 0:t.display)?m("UNMOUNT"):m(n&&r!==a?"ANIMATION_OUT":"UNMOUNT"),c.current=e}}),[e,m]),(0,s.b)((()=>{if(t){const e=e=>{const n=l(o.current).includes(e.animationName);e.target===t&&n&&(0,a.flushSync)((()=>m("ANIMATION_END")))},n=e=>{e.target===t&&(i.current=l(o.current))};return t.addEventListener("animationstart",n),t.addEventListener("animationcancel",e),t.addEventListener("animationend",e),()=>{t.removeEventListener("animationstart",n),t.removeEventListener("animationcancel",e),t.removeEventListener("animationend",e)}}m("ANIMATION_END")}),[t,m]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:(0,r.useCallback)((e=>{e&&(o.current=getComputedStyle(e)),n(e)}),[])}}(t),i="function"==typeof n?n({present:c.isPresent}):r.Children.only(n),d=(0,o.e)(c.ref,i.ref);return"function"==typeof n||c.isPresent?(0,r.cloneElement)(i,{ref:d}):null};function l(e){return(null==e?void 0:e.animationName)||"none"}c.displayName="Presence"},57898:function(e,t,n){n.d(t,{D:function(){return a}});var r=n(99196);function a(e){const t=(0,r.useRef)({value:e,previous:e});return(0,r.useMemo)((()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous)),[e])}}}]);