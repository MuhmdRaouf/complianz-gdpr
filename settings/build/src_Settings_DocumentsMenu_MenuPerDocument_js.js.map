{"version":3,"file":"src_Settings_DocumentsMenu_MenuPerDocument_js.js","mappings":";;;;;;;;;;;;;;;;;;;AAA+B;AACc;AACjB;AACS;AACF;AAE5B,MAAMK,WAAW,GAAGL,+CAAM,CAAC,CAAEM,GAAG,EAAEC,GAAG,MAAO;EAClDC,cAAc,EAAE,KAAK;EACrBC,MAAM,EAAE,KAAK;EACbC,IAAI,EAAE,EAAE;EACRC,WAAW,EAAC,KAAK;EACjBC,eAAe,EAAC,cAAc;EAC9BC,aAAa,EAAC,GAAG;EACjBC,iBAAiB,EAAC,EAAE;EACpBC,gBAAgB,EAAC,EAAE;EACnBC,gBAAgB,EAAC,EAAE;EACnBC,kBAAkB,EAAC,EAAE;EACrBC,SAAS,EAAC,EAAE;EACZC,OAAO,EAAC,EAAE;EACVC,aAAa,EAAE,MAAAA,CAAA,KAAY;IAC1B,MAAMC,QAAQ,GAAG,MAAMD,aAAa,CAAC,KAAK,CAAC;IAC3C,IAAIL,gBAAgB,GAAGM,QAAQ,CAACC,kBAAkB,CAACC,MAAM,CAAEC,QAAQ,IAAIA,QAAQ,CAACC,OAAQ,CAAC;IAEzFnB,GAAG,CAAC;MACHE,cAAc,EAAC,IAAI;MACnBK,aAAa,EAAEQ,QAAQ,CAACK,eAAe;MACvChB,IAAI,EAAEW,QAAQ,CAACX,IAAI;MACnBI,iBAAiB,EAAEO,QAAQ,CAACC,kBAAkB;MAC9CN,gBAAgB,EAAEK,QAAQ,CAACM,sBAAsB;MACjDZ,gBAAgB,EAAEA,gBAAgB;MAClCG,SAAS,EAAEG,QAAQ,CAACO,UAAU;MAC9BX,kBAAkB,EAAEI,QAAQ,CAACQ,qBAAqB;MAClDV,OAAO,EAAEE,QAAQ,CAACF;IACnB,CAAC,CAAC;EACH,CAAC;EACDW,UAAU,EAAEA,CAACL,OAAO,EAAEM,OAAO,KAAK;IACjC,IAAIC,QAAQ,GAAGC,KAAK,CAACR,OAAO,CAAC,GAAG,UAAU,GAAG,cAAc;IAC3DnB,GAAG,CAAC;MAAE0B,QAAQ,EAACA;IAAS,CAAC,CAAC;IAC1B,IAAIA,QAAQ,KAAG,UAAU,EAAE;MAC1B1B,GAAG,CACFJ,iDAAO,CAAEgC,KAAK,IAAK;QAClB,IAAIC,QAAQ,GAAGD,KAAK,CAAClB,gBAAgB,CAACoB,SAAS,CAAC,UAASC,IAAI,EAAEC,CAAC,EAAE;UACjE,OAAOD,IAAI,CAACZ,OAAO,KAAKA,OAAO,IAAIY,IAAI,CAACE,IAAI,KAAKd,OAAO;QACzD,CAAC,CAAC;QACF,IAAIe,YAAY,GAAGN,KAAK,CAACnB,gBAAgB,CAACqB,SAAS,CAAC,UAASC,IAAI,EAAEC,CAAC,EAAE;UACrE,OAAOD,IAAI,CAACZ,OAAO,KAAKA,OAAO,IAAIY,IAAI,CAACE,IAAI,KAAKd,OAAO;QACzD,CAAC,CAAC;QACF,IAAKU,QAAQ,KAAG,CAAC,CAAC,EAAG;UACpBD,KAAK,CAAClB,gBAAgB,CAACmB,QAAQ,CAAC,CAACJ,OAAO,GAAGA,OAAO;UAClD,IAAIS,YAAY,KAAG,CAAC,CAAC,EAAEN,KAAK,CAACnB,gBAAgB,CAACyB,YAAY,CAAC,CAACT,OAAO,GAAG,CAAC,CAAC;UACxEG,KAAK,CAACvB,WAAW,GAAG,IAAI;QACzB;MAED,CAAC,CACF,CAAC;IACF,CAAC,MAAM;MACNL,GAAG,CACFJ,iDAAO,CAAEgC,KAAK,IAAK;QAClB,IAAIC,QAAQ,GAAGD,KAAK,CAAClB,gBAAgB,CAACoB,SAAS,CAAC,UAASC,IAAI,EAAEC,CAAC,EAAE;UACjE,OAAOD,IAAI,CAACZ,OAAO,KAAKA,OAAO,IAAIY,IAAI,CAACE,IAAI,KAAKd,OAAO;QACzD,CAAC,CAAC;QACF,IAAIe,YAAY,GAAGN,KAAK,CAACnB,gBAAgB,CAACqB,SAAS,CAAC,UAASC,IAAI,EAAEC,CAAC,EAAE;UACrE,OAAOD,IAAI,CAACZ,OAAO,KAAKA,OAAO,IAAIY,IAAI,CAACE,IAAI,KAAKd,OAAO;QACzD,CAAC,CAAC;QAAC;QACH,IAAKe,YAAY,KAAG,CAAC,CAAC,EAAG;UACxBN,KAAK,CAACnB,gBAAgB,CAACyB,YAAY,CAAC,CAACT,OAAO,GAAGA,OAAO;UACtD,IAAII,QAAQ,KAAG,CAAC,CAAC,EAAED,KAAK,CAAClB,gBAAgB,CAACmB,QAAQ,CAAC,CAACJ,OAAO,GAAG,CAAC,CAAC;UAChEG,KAAK,CAACvB,WAAW,GAAG,IAAI;QACzB;MACD,CAAC,CACF,CAAC;IACF;EACD,CAAC;EACD8B,iBAAiB,EAAE,MAAAA,CAAOC,gBAAgB,EAAEC,UAAU,KAAK;IAC1DrC,GAAG,CAAC;MAACG,MAAM,EAAC;IAAK,CAAC,CAAC;IACnB,IAAIE,WAAW,GAAGJ,GAAG,CAAC,CAAC,CAACI,WAAW;IACnC,IAAKA,WAAW,IAAI+B,gBAAgB,EAAG;MACtC,IAAIE,IAAI,GAAG,CAAC,CAAC;MACb;MACAA,IAAI,CAAC5B,gBAAgB,GAAGT,GAAG,CAAC,CAAC,CAACS,gBAAgB,CAACO,MAAM,CAACC,QAAQ,IAAIA,QAAQ,CAACqB,mBAAmB,CAAC;MAC/FD,IAAI,CAAC7B,gBAAgB,GAAGR,GAAG,CAAC,CAAC,CAACQ,gBAAgB;MAC9C,MAAMM,QAAQ,GAAGpB,gDAAkB,CAAC,0BAA0B,EAAE2C,IAAI,CAAC,CAACG,IAAI,CAAE1B,QAAQ,IAAK;QACxFf,GAAG,CAAC;UAACG,MAAM,EAAC;QAAM,CAAC,CAAC;QACpB,OAAOY,QAAQ;MAChB,CAAC,CAAC,CAAC2B,KAAK,CAAEC,KAAK,IAAK;QACnBC,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC;MACrB,CAAC,CAAC;MACFN,UAAU,IAAIxC,yDAAa,CAC1BkB,QAAQ,EACR;QACC+B,OAAO,EAAEhD,mDAAE,CAAC,gBAAgB,EAAE,gBAAgB,CAAC;QAC/CiD,OAAO,EAAEjD,mDAAE,CAAC,YAAY,EAAE,gBAAgB,CAAC;QAC3C6C,KAAK,EAAE7C,mDAAE,CAAC,sBAAsB,EAAE,gBAAgB;MACnD,CACD,CAAC;IACF,CAAC,MAAM;MACNuC,UAAU,IAAIxC,sDAAU,CAACC,mDAAE,CAAC,gCAAgC,EAAC,gBAAgB,CAAC,CAAC;IAChF;EAED;AACD,CAAC,CAAC,CAAC;AAEH,MAAMgB,aAAa,GAAGA,CAAA,KAAM;EAC3B,IAAIwB,IAAI,GAAG,CAAC,CAAC;EACbA,IAAI,CAACW,QAAQ,GAAG,KAAK;EACrB,OAAOtD,gDAAkB,CAAC,qBAAqB,EAAE2C,IAAI,CAAC,CAACG,IAAI,CAAE1B,QAAQ,IAAK;IACzE,OAAOA,QAAQ;EAChB,CAAC,CAAC,CAAC2B,KAAK,CAAEC,KAAK,IAAK;IACnBC,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC;EACrB,CAAC,CAAC;AACH,CAAC;;;;;;;;;;;;;;;;;;;;;AC9GsC;AAC6B;AACzC;AAE3B,MAAMS,eAAe,GAAIC,KAAK,IAAK;EAClC,MAAM;IAAC5C;EAAgB,CAAC,GAAGV,sDAAW,CAAC,CAAC;EACxC;EACA,IAAIuD,eAAe,GAAG7C,gBAAgB,CAACQ,MAAM,CAAEC,QAAQ,IAAIA,QAAQ,CAACqC,MAAM,KAAKF,KAAK,CAACE,MAAM,CAACC,EAAG,CAAC;EAChG,IAAKF,eAAe,CAACG,MAAM,KAAG,CAAC,EAAG;IACjC,OAAOC,iEAAA,CAAAC,wDAAA,MAAI,CAAC;EACb;EAEA,OACCD,iEAAA,cACCA,iEAAA;IAAIE,SAAS,EAAC;EAAU,GAAGP,KAAK,CAACE,MAAM,CAACM,KAAW,CAAC,EAClDP,eAAe,CAACQ,GAAG,CAAE,CAAC5C,QAAQ,EAAEc,CAAC,KAAI0B,iEAAA,CAACR,kEAAyB;IAACa,GAAG,EAAE/B,CAAE;IAACd,QAAQ,EAAEA;EAAS,CAAC,CAAE,CAC5F,CAAC;AAGR,CAAC;AACD,iEAAeiC,2CAAI,CAACC,eAAe,CAAC;;;;;;;;;;;;;;;;;;;;;;ACpBG;AACF;AACV;AAE3B,MAAMF,yBAAyB,GAAIG,KAAK,IAAK;EAC5C,MAAM;IAAEjD,IAAI;IAAEoB;EAAW,CAAC,GAAGzB,sDAAW,CAAC,CAAC;EAC1C,MAAMiE,eAAe,GAAIC,CAAC,IAAK;IAC9BzC,UAAU,CAAC6B,KAAK,CAACnC,QAAQ,CAACC,OAAO,EAAE8C,CAAC,CAACC,MAAM,CAACC,KAAK,CAAC;EACnD,CAAC;EAED,OACCT,iEAAA;IAAKE,SAAS,EAAC;EAA4B,GAC1CF,iEAAA;IAAKE,SAAS,EAAC;EAA2B,GAAEP,KAAK,CAACnC,QAAQ,CAACkD,KAAW,CAAC,EACvEV,iEAAA;IAAQS,KAAK,EAAEd,KAAK,CAACnC,QAAQ,CAACO,OAAQ;IAAC4C,QAAQ,EAAGJ,CAAC,IAAKD,eAAe,CAACC,CAAC;EAAE,GAC1EP,iEAAA;IAAQS,KAAK,EAAE,CAAC,CAAE;IAACJ,GAAG,EAAE,CAAC;EAAE,GAAEjE,mDAAE,CAAC,eAAe,EAAC,gBAAgB,CAAU,CAAC,EAC1EM,IAAI,CAAC0D,GAAG,CAAE,CAACQ,QAAQ,EAAEtC,CAAC,KAAI0B,iEAAA;IAAQK,GAAG,EAAE/B,CAAE;IAACmC,KAAK,EAAEG,QAAQ,CAACd;EAAG,GAAEc,QAAQ,CAACT,KAAc,CAAE,CAClF,CACJ,CAAC;AAGR,CAAC;AACD,iEAAeV,2CAAI,CAACD,yBAAyB,CAAC","sources":["webpack://complianz-gdpr/./src/Settings/DocumentsMenu/MenuData.js","webpack://complianz-gdpr/./src/Settings/DocumentsMenu/MenuPerDocument.js","webpack://complianz-gdpr/./src/Settings/DocumentsMenu/SingleDocumentMenuControl.js"],"sourcesContent":["import {create} from 'zustand';\nimport * as cmplz_api from \"../../utils/api\";\nimport produce from \"immer\";\nimport {toast} from \"react-toastify\";\nimport {__} from '@wordpress/i18n';\n\nexport const UseMenuData = create(( set, get ) => ({\n\tmenuDataLoaded: false,\n\tsaving: false,\n\tmenu: [],\n\tmenuChanged:false,\n\tchangedMenuType:'per_document',\n\temptyMenuLink:'#',\n\trequiredDocuments:[],\n\tcreatedDocuments:[],\n\tgenericDocuments:[],\n\tdocumentsNotInMenu:[],\n\tpageTypes:[],\n\tregions:[],\n\tfetchMenuData: async () => {\n\t\tconst response = await fetchMenuData(false);\n\t\tlet createdDocuments = response.required_documents.filter( document => document.page_id );\n\n\t\tset({\n\t\t\tmenuDataLoaded:true,\n\t\t\temptyMenuLink: response.empty_menu_link,\n\t\t\tmenu: response.menu,\n\t\t\trequiredDocuments: response.required_documents,\n\t\t\tgenericDocuments: response.generic_documents_list,\n\t\t\tcreatedDocuments: createdDocuments,\n\t\t\tpageTypes: response.page_types,\n\t\t\tdocumentsNotInMenu: response.documents_not_in_menu,\n\t\t\tregions: response.regions,\n\t\t});\n\t},\n\tupdateMenu: (page_id, menu_id) => {\n\t\tlet menuType = isNaN(page_id) ? 'per_type' : 'per_document';\n\t\tset({ menuType:menuType });\n\t\tif (menuType==='per_type') {\n\t\t\tset(\n\t\t\t\tproduce((state) => {\n\t\t\t\t\tlet genIndex = state.genericDocuments.findIndex(function(page, i) {\n\t\t\t\t\t\treturn page.page_id === page_id || page.type === page_id;\n\t\t\t\t\t});\n\t\t\t\t\tlet createdIndex = state.createdDocuments.findIndex(function(page, i) {\n\t\t\t\t\t\treturn page.page_id === page_id || page.type === page_id;\n\t\t\t\t\t});\n\t\t\t\t\tif ( genIndex!==-1 ) {\n\t\t\t\t\t\tstate.genericDocuments[genIndex].menu_id = menu_id;\n\t\t\t\t\t\tif (createdIndex!==-1) state.createdDocuments[createdIndex].menu_id = -1;\n\t\t\t\t\t\tstate.menuChanged = true;\n\t\t\t\t\t}\n\n\t\t\t\t})\n\t\t\t)\n\t\t} else {\n\t\t\tset(\n\t\t\t\tproduce((state) => {\n\t\t\t\t\tlet genIndex = state.genericDocuments.findIndex(function(page, i) {\n\t\t\t\t\t\treturn page.page_id === page_id || page.type === page_id;\n\t\t\t\t\t});\n\t\t\t\t\tlet createdIndex = state.createdDocuments.findIndex(function(page, i) {\n\t\t\t\t\t\treturn page.page_id === page_id || page.type === page_id;\n\t\t\t\t\t});;\n\t\t\t\t\tif ( createdIndex!==-1 ) {\n\t\t\t\t\t\tstate.createdDocuments[createdIndex].menu_id = menu_id;\n\t\t\t\t\t\tif (genIndex!==-1) state.genericDocuments[genIndex].menu_id = -1;\n\t\t\t\t\t\tstate.menuChanged = true;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t)\n\t\t}\n\t},\n\tsaveDocumentsMenu: async (hasChangedFields, showNotice) => {\n\t\tset({saving:true });\n\t\tlet menuChanged = get().menuChanged;\n\t\tif ( menuChanged || hasChangedFields ) {\n\t\t\tlet data = {};\n\t\t\t//post for generic documents only the redirected ones.\n\t\t\tdata.genericDocuments = get().genericDocuments.filter(document => document.can_region_redirect);\n\t\t\tdata.createdDocuments = get().createdDocuments;\n\t\t\tconst response = cmplz_api.doAction('save_documents_menu_data', data).then((response) => {\n\t\t\t\tset({saving:false });\n\t\t\t\treturn response;\n\t\t\t}).catch((error) => {\n\t\t\t\tconsole.error(error);\n\t\t\t});\n\t\t\tshowNotice && toast.promise(\n\t\t\t\tresponse,\n\t\t\t\t{\n\t\t\t\t\tpending: __('Saving menu...', 'complianz-gdpr'),\n\t\t\t\t\tsuccess: __('Menu saved', 'complianz-gdpr'),\n\t\t\t\t\terror: __('Something went wrong', 'complianz-gdpr'),\n\t\t\t\t}\n\t\t\t);\n\t\t} else {\n\t\t\tshowNotice && toast.info(__('Settings have not been changed','complianz-gdpr'));\n\t\t}\n\n\t},\n}));\n\nconst fetchMenuData = () => {\n\tlet data = {};\n\tdata.generate = false;\n\treturn cmplz_api.doAction('documents_menu_data', data).then((response) => {\n\t\treturn response;\n\t}).catch((error) => {\n\t\tconsole.error(error);\n\t});\n}\n\n\n\n","import {UseMenuData} from \"./MenuData\";\nimport SingleDocumentMenuControl from \"./SingleDocumentMenuControl\";\nimport {memo} from \"react\";\n\nconst MenuPerDocument = (props) => {\n\tconst {createdDocuments} = UseMenuData();\n\t//filter out this region from the documents\n\tlet regionDocuments = createdDocuments.filter( document => document.region === props.region.id );\n\tif ( regionDocuments.length===0 ) {\n\t\treturn <></>\n\t}\n\n\treturn (\n\t\t<div>\n\t\t\t<h3 className=\"cmplz-h4\">{ props.region.label }</h3>\n\t\t\t{ regionDocuments.map( (document, i)=> <SingleDocumentMenuControl key={i} document={document}/> )}\n\t\t</div>\n\t)\n\n}\nexport default memo(MenuPerDocument)\n","import {UseMenuData} from \"./MenuData\";\nimport { __ } from '@wordpress/i18n';\nimport {memo} from \"react\";\n\nconst SingleDocumentMenuControl = (props) => {\n\tconst { menu, updateMenu } = UseMenuData();\n\tconst onChangeHandler = (e) => {\n\t\tupdateMenu(props.document.page_id, e.target.value);\n\t}\n\n\treturn (\n\t\t<div className=\"cmplz-single-document-menu\">\n\t\t\t<div className=\"cmplz-document-menu-title\">{props.document.title}</div>\n\t\t\t<select value={props.document.menu_id} onChange={(e) => onChangeHandler(e)}>\n\t\t\t\t<option value={-1} key={-1}>{__(\"Select a menu\",\"complianz-gdpr\")}</option>\n\t\t\t\t{menu.map( (menuItem, i)=> <option key={i} value={menuItem.id}>{menuItem.label}</option> )}\n\t\t\t</select>\n\t\t</div>\n\t)\n\n}\nexport default memo(SingleDocumentMenuControl)\n"],"names":["create","cmplz_api","produce","toast","__","UseMenuData","set","get","menuDataLoaded","saving","menu","menuChanged","changedMenuType","emptyMenuLink","requiredDocuments","createdDocuments","genericDocuments","documentsNotInMenu","pageTypes","regions","fetchMenuData","response","required_documents","filter","document","page_id","empty_menu_link","generic_documents_list","page_types","documents_not_in_menu","updateMenu","menu_id","menuType","isNaN","state","genIndex","findIndex","page","i","type","createdIndex","saveDocumentsMenu","hasChangedFields","showNotice","data","can_region_redirect","doAction","then","catch","error","console","promise","pending","success","info","generate","SingleDocumentMenuControl","memo","MenuPerDocument","props","regionDocuments","region","id","length","createElement","Fragment","className","label","map","key","onChangeHandler","e","target","value","title","onChange","menuItem"],"sourceRoot":""}