{"version":3,"file":"src_Dashboard_TaskElement_js.js","mappings":"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","sources":["webpack://complianz-gdpr/./src/Dashboard/TaskElement.js","webpack://complianz-gdpr/./src/utils/sleeper.js"],"sourcesContent":["import { __ } from '@wordpress/i18n';\nimport Icon from '../utils/Icon'\nimport {dispatch,} from '@wordpress/data';\nimport * as rsssl_api from \"../utils/api\";\nimport sleeper from \"../utils/sleeper\";\nimport useFields from \"../Settings/Fields/FieldsData\";\nimport useProgress from \"./Progress/ProgressData\";\nimport useMenu from \"../Menu/MenuData\";\n\nconst TaskElement = (props) => {\n\tconst {dismissNotice, fetchProgressData} = useProgress();\n\tconst {getField, setHighLightField, fetchFieldsData} = useFields();\n\tconst {setSelectedSubMenuItem} = useMenu();\n\n\tconst handleClick = async () => {\n\t\tsetHighLightField(props.notice.highlight_field_id);\n\t\tlet highlightField = getField(props.notice.highlight_field_id);\n\t\tawait setSelectedSubMenuItem(highlightField.menu_id);\n\t}\n\n\tconst handleClearCache = async (cache_id) => {\n\t\tlet data = {};\n\t\tdata.cache_id = cache_id;\n\t\trsssl_api.doAction('clear_cache', data).then( async (response) => {\n\t\t\tconst notice = dispatch('core/notices').createNotice(\n\t\t\t\t'success',\n\t\t\t\t__('Re-started test', 'complianz-gdpr'),\n\t\t\t\t{\n\t\t\t\t\t__unstableHTML: true,\n\t\t\t\t\tid: 'cmplz_clear_cache',\n\t\t\t\t\ttype: 'snackbar',\n\t\t\t\t\tisDismissible: true,\n\t\t\t\t}\n\t\t\t).then(sleeper(3000)).then((response) => {\n\t\t\t\tdispatch('core/notices').removeNotice('rsssl_clear_cache');\n\t\t\t});\n\t\t\tawait fetchFieldsData();\n\t\t\tawait fetchProgressData();\n\t\t});\n\t}\n\n\tlet notice = props.notice;\n\tlet premium = notice.icon==='premium';\n\t//treat links to complianz.io and internal links different.\n\tlet urlIsExternal = notice.url && notice.url.indexOf('complianz.io') !== -1;\n\tlet statusNice =  notice.status.charAt(0).toUpperCase() +  notice.status.slice(1);\n\treturn(\n\t\t<div className=\"cmplz-task-element\">\n\t\t\t<span className={'cmplz-task-status cmplz-' + notice.status}>{ statusNice }</span>\n\t\t\t<p className=\"cmplz-task-message\" dangerouslySetInnerHTML={{__html: notice.message}}></p>\n\t\t\t{urlIsExternal && notice.url && <a target=\"_blank\" href={notice.url}>{__(\"More info\", \"complianz-gdpr\")}</a> }\n\t\t\t{notice.clear_cache_id && <span className=\"cmplz-task-enable button button-secondary\" onClick={ () => handleClearCache(notice.clear_cache_id ) }>{__(\"Re-check\", \"complianz-gdpr\")}</span> }\n\t\t\t{!premium && !urlIsExternal && notice.url && <a className=\"cmplz-task-enable button button-secondary\" href={notice.url}>{__(\"Fix\", \"complianz-gdpr\")}</a> }\n\t\t\t{!premium && notice.highlight_field_id && <span className=\"cmplz-task-enable button button-secondary\" onClick={() => handleClick()}>{__(\"Fix\", \"complianz-gdpr\")}</span> }\n\t\t\t{notice.plusone && <span className='cmplz-plusone'>1</span>}\n\t\t\t{notice.dismissible && notice.status!=='completed' &&\n\t\t\t\t<div className=\"cmplz-task-dismiss\">\n\t\t\t\t\t<button type='button' onClick={(e) => dismissNotice(notice.id) }>\n\t\t\t\t\t\t<Icon name='times' />\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t}\n\t\t</div>\n\t);\n}\n\nexport default TaskElement;\n","/*\n * helper function to delay after a promise\n * @param ms\n * @returns {function(*): Promise<unknown>}\n */\nconst sleeper = (ms) => {\n    return function(x) {\n        return new Promise(resolve => setTimeout(() => resolve(x), ms));\n    };\n}\nexport default sleeper;"],"names":["__","Icon","dispatch","rsssl_api","sleeper","useFields","useProgress","useMenu","TaskElement","props","dismissNotice","fetchProgressData","getField","setHighLightField","fetchFieldsData","setSelectedSubMenuItem","handleClick","notice","highlight_field_id","highlightField","menu_id","handleClearCache","cache_id","data","doAction","then","response","createNotice","__unstableHTML","id","type","isDismissible","removeNotice","premium","icon","urlIsExternal","url","indexOf","statusNice","status","charAt","toUpperCase","slice","createElement","className","dangerouslySetInnerHTML","__html","message","target","href","clear_cache_id","onClick","plusone","dismissible","e","name","ms","x","Promise","resolve","setTimeout"],"sourceRoot":""}